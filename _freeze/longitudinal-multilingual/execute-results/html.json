{
  "hash": "8a5612279dfefc32c3ddfb6dc149e0d3",
  "result": {
    "engine": "knitr",
    "markdown": "# Longitudinal Multilevel Models\n\n\n::: {.cell}\n\n:::\n\n\n## The Data\n\nThe data employed in these examples are a longitudinal extension of the data described in @sec-data.\n\n## The Equation\n\n$$\\text{outcome}_{itj} = \\beta_0 + \\beta_1 \\text{parental warmth}_{itj} + \\beta_2 \\text{physical punishment}_{itj} + \\beta_3 \\text{time}_{itj} \\ + $$ {#eq-MLM-longitudinal} \n\n$$\\beta_4 \\text{identity}_{itj} + \\beta_5 \\text{intervention}_{itj} + \\beta_6 \\text{HDI}_{itj} +$$\n\n$$u_{0j} + u_{1j} \\times \\text{parental warmth}_{itj} \\ + $$\n\n$$v_{0i} + v_{1i} \\times \\text{time}_{itj} + e_{itj}$$\n\n## Run Models\n\n::: {.panel-tabset group=\"language\"}\n\n### Stata\n\n#### Get The Data \n\n\n::: {.cell collectcode='true'}\n\n```{.stata .cell-code}\n\nuse simulated_multilevel_longitudinal_data.dta\n\n```\n:::\n\n\n#### Run The Model\n\n##### Main Effects Only\n\n\n::: {.cell}\n\n```{.stata .cell-code}\n\nmixed outcome t warmth physical_punishment i.identity i.intervention HDI || country: warmth\n\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPerforming EM optimization ...\n\nPerforming gradient-based optimization: \nIteration 0:  Log likelihood = -28739.506  \nIteration 1:  Log likelihood = -28739.506  \n\nComputing standard errors ...\n\nMixed-effects ML regression                         Number of obs    =   9,000\nGroup variable: country                             Number of groups =      30\n                                                    Obs per group:\n                                                                 min =     300\n                                                                 avg =   300.0\n                                                                 max =     300\n                                                    Wald chi2(6)     = 1119.81\nLog likelihood = -28739.506                         Prob > chi2      =  0.0000\n\n-------------------------------------------------------------------------------------\n            outcome | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n--------------------+----------------------------------------------------------------\n                  t |   .9443446   .0756408    12.48   0.000     .7960914    1.092598\n             warmth |   .9123903   .0430042    21.22   0.000     .8281035     .996677\nphysical_punishment |  -.9881587   .0451732   -21.87   0.000    -1.076696   -.8996209\n         2.identity |  -.1241465   .1242225    -1.00   0.318     -.367618    .1193251\n     2.intervention |   .8575839   .1245179     6.89   0.000     .6135332    1.101635\n                HDI |  -.0025173   .0191696    -0.13   0.896    -.0400891    .0350544\n              _cons |   51.54528   1.304146    39.52   0.000      48.9892    54.10136\n-------------------------------------------------------------------------------------\n\n------------------------------------------------------------------------------\n  Random-effects parameters  |   Estimate   Std. err.     [95% conf. interval]\n-----------------------------+------------------------------------------------\ncountry: Independent         |\n                 var(warmth) |   .0229349   .0135353      .0072136    .0729194\n                  var(_cons) |     3.0009   .8550708      1.716768    5.245553\n-----------------------------+------------------------------------------------\n               var(Residual) |   34.31935   .5130963       33.3283    35.33988\n------------------------------------------------------------------------------\nLR test vs. linear model: chi2(2) = 767.22                Prob > chi2 = 0.0000\n\nNote: LR test is conservative and provided only for reference.\n```\n\n\n:::\n:::\n\n\n##### Interactions With Time\n\n\n::: {.cell}\n\n```{.stata .cell-code}\n\nmixed outcome c.t##(c.warmth c.physical_punishment i.identity i.intervention c.HDI) || country: warmth\n\n```\n\n\n::: {.cell-output .cell-output-stdout}\n\n```\nPerforming EM optimization ...\n\nPerforming gradient-based optimization: \nIteration 0:  Log likelihood = -28738.554  \nIteration 1:  Log likelihood = -28738.554  \n\nComputing standard errors ...\n\nMixed-effects ML regression                         Number of obs    =   9,000\nGroup variable: country                             Number of groups =      30\n                                                    Obs per group:\n                                                                 min =     300\n                                                                 avg =   300.0\n                                                                 max =     300\n                                                    Wald chi2(11)    = 1122.75\nLog likelihood = -28738.554                         Prob > chi2      =  0.0000\n\n---------------------------------------------------------------------------------------\n              outcome | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]\n----------------------+----------------------------------------------------------------\n                    t |   .7537359   .3719996     2.03   0.043     .0246302    1.482842\n               warmth |   .8198365   .0911059     9.00   0.000     .6412723    .9984008\n  physical_punishment |  -1.000348   .1198049    -8.35   0.000    -1.235162   -.7655353\n           2.identity |  -.2340191   .3271243    -0.72   0.474     -.875171    .4071328\n       2.intervention |   .6597456   .3275877     2.01   0.044     .0176856    1.301806\n                  HDI |  -.0005531   .0210866    -0.03   0.979     -.041882    .0407757\n                      |\n         c.t#c.warmth |   .0463746   .0402459     1.15   0.249    -.0325059    .1252551\n                      |\n                  c.t#|\nc.physical_punishment |   .0061255   .0551491     0.11   0.912    -.1019647    .1142157\n                      |\n         identity#c.t |\n                   2  |   .0548965   .1513015     0.36   0.717     -.241649    .3514421\n                      |\n     intervention#c.t |\n                   2  |   .0990704    .151503     0.65   0.513      -.19787    .3960108\n                      |\n            c.t#c.HDI |  -.0009791   .0043888    -0.22   0.823    -.0095811    .0076229\n                      |\n                _cons |   51.92503   1.494157    34.75   0.000     48.99654    54.85352\n---------------------------------------------------------------------------------------\n\n------------------------------------------------------------------------------\n  Random-effects parameters  |   Estimate   Std. err.     [95% conf. interval]\n-----------------------------+------------------------------------------------\ncountry: Independent         |\n                 var(warmth) |   .0228292   .0135078      .0071588    .0728013\n                  var(_cons) |   3.001849   .8552796       1.71738    5.247001\n-----------------------------+------------------------------------------------\n               var(Residual) |   34.31227   .5129896      33.32141    35.33258\n------------------------------------------------------------------------------\nLR test vs. linear model: chi2(2) = 767.35                Prob > chi2 = 0.0000\n\nNote: LR test is conservative and provided only for reference.\n```\n\n\n:::\n:::\n\n\n### R\n\n#### Get The Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(haven)\n\ndfL <- read_dta(\"simulated_multilevel_longitudinal_data.dta\")\n```\n:::\n\n\n#### Run The Model\n\n##### Main Effects Only\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit2A <- lmer(outcome ~ t + warmth + physical_punishment + \n               identity + intervention + HDI +\n               (1 | country/id),\n             data = dfL)\n\nsummary(fit2A)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: \noutcome ~ t + warmth + physical_punishment + identity + intervention +  \n    HDI + (1 | country/id)\n   Data: dfL\n\nREML criterion at convergence: 57022.7\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.6850 -0.6094 -0.0035  0.6133  3.6792 \n\nRandom effects:\n Groups     Name        Variance Std.Dev.\n id:country (Intercept)  8.438   2.905   \n country    (Intercept)  3.675   1.917   \n Residual               26.036   5.103   \nNumber of obs: 9000, groups:  id:country, 3000; country, 30\n\nFixed effects:\n                      Estimate Std. Error t value\n(Intercept)         50.6570397  1.4460656  35.031\nt                    0.9433806  0.0658755  14.321\nwarmth               0.9140307  0.0379336  24.096\nphysical_punishment -1.0087537  0.0497972 -20.257\nidentity            -0.1319548  0.1517350  -0.870\nintervention         0.8591495  0.1520510   5.650\nHDI                  0.0007909  0.0207656   0.038\n\nCorrelation of Fixed Effects:\n            (Intr) t      warmth physc_ idntty intrvn\nt           -0.090                                   \nwarmth      -0.091 -0.002                            \nphyscl_pnsh -0.091 -0.007 -0.012                     \nidentity    -0.152  0.000 -0.013 -0.003              \ninterventin -0.160  0.000  0.039  0.019 -0.018       \nHDI         -0.930  0.000 -0.004  0.005  0.000  0.002\n```\n\n\n:::\n:::\n\n\n##### Interactions With Time\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit2B <- lmer(outcome ~ t *(warmth + physical_punishment + \n               identity + intervention + HDI) +\n               (1 | country/id),\n             data = dfL)\n\nsummary(fit2B)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLinear mixed model fit by REML ['lmerMod']\nFormula: \noutcome ~ t * (warmth + physical_punishment + identity + intervention +  \n    HDI) + (1 | country/id)\n   Data: dfL\n\nREML criterion at convergence: 57042.8\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.7118 -0.6092 -0.0024  0.6150  3.6779 \n\nRandom effects:\n Groups     Name        Variance Std.Dev.\n id:country (Intercept)  8.436   2.905   \n country    (Intercept)  3.675   1.917   \n Residual               26.046   5.104   \nNumber of obs: 9000, groups:  id:country, 3000; country, 30\n\nFixed effects:\n                        Estimate Std. Error t value\n(Intercept)           51.3432052  1.6670196  30.799\nt                      0.5994732  0.4199189   1.428\nwarmth                 0.8170912  0.0805355  10.146\nphysical_punishment   -1.0097729  0.1113557  -9.068\nidentity              -0.2446453  0.3041604  -0.804\nintervention           0.6604672  0.3046286   2.168\nHDI                    0.0026692  0.0221295   0.121\nt:warmth               0.0486211  0.0356217   1.365\nt:physical_punishment  0.0004964  0.0494590   0.010\nt:identity             0.0563140  0.1318043   0.427\nt:intervention         0.0995037  0.1319917   0.754\nt:HDI                 -0.0009379  0.0038233  -0.245\n\nCorrelation of Fixed Effects:\n            (Intr) t      warmth physc_ idntty intrvn HDI    t:wrmt t:phy_\nt           -0.504                                                        \nwarmth      -0.170  0.265                                                 \nphyscl_pnsh -0.180  0.285 -0.005                                          \nidentity    -0.266  0.397 -0.013 -0.002                                   \ninterventin -0.279  0.417  0.039  0.019 -0.017                            \nHDI         -0.861  0.206 -0.007  0.012 -0.001  0.003                     \nt:warmth     0.151 -0.302 -0.882  0.001  0.011 -0.035  0.006              \nt:physcl_pn  0.161 -0.319  0.004 -0.894 -0.001 -0.017 -0.010 -0.003       \nt:identity   0.230 -0.458  0.011  0.000 -0.867  0.014  0.001 -0.013  0.002\nt:intervntn  0.242 -0.481 -0.035 -0.017  0.014 -0.867 -0.003  0.041  0.019\nt:HDI        0.301 -0.596  0.015 -0.027  0.002 -0.007 -0.346 -0.016  0.029\n            t:dntt t:ntrv\nt                        \nwarmth                   \nphyscl_pnsh              \nidentity                 \ninterventin              \nHDI                      \nt:warmth                 \nt:physcl_pn              \nt:identity               \nt:intervntn -0.016       \nt:HDI       -0.002  0.008\n```\n\n\n:::\n:::\n\n\n\n### Julia\n\n#### Get The Data\n\n\n::: {.cell}\n\n```{.julia .cell-code}\nusing Tables, MixedModels, StatFiles, DataFrames, CategoricalArrays, DataFramesMeta\n\ndfL = DataFrame(load(\"simulated_multilevel_longitudinal_data.dta\"))\n```\n:::\n\n\n#### Run The Model\n\n##### Change Country To Categorical\n\n\n::: {.cell}\n\n```{.julia .cell-code}\n@transform!(dfL, :country = categorical(:country))\n```\n:::\n\n\n##### Main Effects Only\n\n\n::: {.cell}\n\n```{.julia .cell-code}\n\nm2A = fit(MixedModel, @formula(outcome ~ t + warmth + \n                                 physical_punishment + \n                                 identity + intervention + \n                                 HDI +\n                                 (1 | country) + \n                                 (0 + warmth | country) +\n                                 (1 | id)), dfL)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLinear mixed model fit by maximum likelihood\n outcome ~ 1 + t + warmth + physical_punishment + identity + intervention + HDI + (1 | country) + (0 + warmth | country) + (1 | id)\n    logLik   -2 logLik      AIC         AICc        BIC     \n -28499.6031  56999.2062  57021.2062  57021.2356  57099.3610\n\nVariance components:\n            Column    Variance Std.Dev.   Corr.\nid       (Intercept)   8.387258 2.896076\ncountry  (Intercept)   3.166920 1.779584\n         warmth        0.010761 0.103736   .  \nResidual              26.027344 5.101700\n Number of obs: 9000; levels of grouping factors: 3000, 30\n\n  Fixed-effects parameters:\n───────────────────────────────────────────────────────────────\n                            Coef.  Std. Error       z  Pr(>|z|)\n───────────────────────────────────────────────────────────────\n(Intercept)          50.7359        1.37201     36.98    <1e-99\nt                     0.943864      0.0658716   14.33    <1e-45\nwarmth                0.913496      0.0423741   21.56    <1e-99\nphysical_punishment  -1.0079        0.0497622  -20.25    <1e-90\nidentity             -0.127692      0.151583    -0.84    0.3996\nintervention          0.858997      0.151909     5.65    <1e-07\nHDI                  -0.000565959   0.0196433   -0.03    0.9770\n───────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n\n\n##### Interactions With Time\n\n\n::: {.cell}\n\n```{.julia .cell-code}\n\nm2B = fit(MixedModel, @formula(outcome ~ t * (warmth + \n                                 physical_punishment + \n                                 identity + intervention + \n                                   HDI) +\n                                 (1 | country) +\n                                 (0 + warmth | country) +\n                                 (1 | id)), dfL)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nLinear mixed model fit by maximum likelihood\n outcome ~ 1 + t + warmth + physical_punishment + identity + intervention + HDI + t & warmth + t & physical_punishment + t & identity + t & intervention + t & HDI + (1 | country) + (0 + warmth | country) + (1 | id)\n    logLik   -2 logLik      AIC         AICc        BIC     \n -28498.3091  56996.6182  57028.6182  57028.6788  57142.2979\n\nVariance components:\n            Column    Variance Std.Dev.   Corr.\nid       (Intercept)   8.391748 2.896851\ncountry  (Intercept)   3.170040 1.780461\n         warmth        0.010609 0.102999   .  \nResidual              26.015905 5.100579\n Number of obs: 9000; levels of grouping factors: 3000, 30\n\n  Fixed-effects parameters:\n──────────────────────────────────────────────────────────────────\n                                Coef.  Std. Error      z  Pr(>|z|)\n──────────────────────────────────────────────────────────────────\n(Intercept)              51.4143       1.60324     32.07    <1e-99\nt                         0.60349      0.419741     1.44    0.1505\nwarmth                    0.817076     0.0826636    9.88    <1e-22\nphysical_punishment      -1.00903      0.111293    -9.07    <1e-18\nidentity                 -0.238714     0.303996    -0.79    0.4323\nintervention              0.660761     0.30445      2.17    0.0300\nHDI                       0.00136065   0.0210842    0.06    0.9485\nt & warmth                0.0483635    0.0356074    1.36    0.1744\nt & physical_punishment   0.0005422    0.0494355    0.01    0.9912\nt & identity              0.0554384    0.131745     0.42    0.6739\nt & intervention          0.0992809    0.131925     0.75    0.4517\nt & HDI                  -0.000955067  0.00382162  -0.25    0.8027\n──────────────────────────────────────────────────────────────────\n```\n\n\n:::\n:::\n\n\n:::\n\n\n",
    "supporting": [
      "longitudinal-multilingual_files/figure-html"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}