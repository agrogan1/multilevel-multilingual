% Options for packages loaded elsewhere
\PassOptionsToPackage{unicode}{hyperref}
\PassOptionsToPackage{hyphens}{url}
\PassOptionsToPackage{dvipsnames,svgnames,x11names}{xcolor}
%
\documentclass[
  letterpaper,
  DIV=11,
  numbers=noendperiod]{scrreprt}

\usepackage{amsmath,amssymb}
\usepackage{iftex}
\ifPDFTeX
  \usepackage[T1]{fontenc}
  \usepackage[utf8]{inputenc}
  \usepackage{textcomp} % provide euro and other symbols
\else % if luatex or xetex
  \usepackage{unicode-math}
  \defaultfontfeatures{Scale=MatchLowercase}
  \defaultfontfeatures[\rmfamily]{Ligatures=TeX,Scale=1}
\fi
\usepackage{lmodern}
\ifPDFTeX\else  
    % xetex/luatex font selection
\fi
% Use upquote if available, for straight quotes in verbatim environments
\IfFileExists{upquote.sty}{\usepackage{upquote}}{}
\IfFileExists{microtype.sty}{% use microtype if available
  \usepackage[]{microtype}
  \UseMicrotypeSet[protrusion]{basicmath} % disable protrusion for tt fonts
}{}
\makeatletter
\@ifundefined{KOMAClassName}{% if non-KOMA class
  \IfFileExists{parskip.sty}{%
    \usepackage{parskip}
  }{% else
    \setlength{\parindent}{0pt}
    \setlength{\parskip}{6pt plus 2pt minus 1pt}}
}{% if KOMA class
  \KOMAoptions{parskip=half}}
\makeatother
\usepackage{xcolor}
\setlength{\emergencystretch}{3em} % prevent overfull lines
\setcounter{secnumdepth}{5}
% Make \paragraph and \subparagraph free-standing
\ifx\paragraph\undefined\else
  \let\oldparagraph\paragraph
  \renewcommand{\paragraph}[1]{\oldparagraph{#1}\mbox{}}
\fi
\ifx\subparagraph\undefined\else
  \let\oldsubparagraph\subparagraph
  \renewcommand{\subparagraph}[1]{\oldsubparagraph{#1}\mbox{}}
\fi

\usepackage{color}
\usepackage{fancyvrb}
\newcommand{\VerbBar}{|}
\newcommand{\VERB}{\Verb[commandchars=\\\{\}]}
\DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
% Add ',fontsize=\small' for more characters per line
\usepackage{framed}
\definecolor{shadecolor}{RGB}{241,243,245}
\newenvironment{Shaded}{\begin{snugshade}}{\end{snugshade}}
\newcommand{\AlertTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.40,0.45,0.13}{#1}}
\newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\BuiltInTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\CharTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\CommentTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.56,0.35,0.01}{#1}}
\newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DecValTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}
\newcommand{\ErrorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\ExtensionTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\FloatTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.28,0.35,0.67}{#1}}
\newcommand{\ImportTok}[1]{\textcolor[rgb]{0.00,0.46,0.62}{#1}}
\newcommand{\InformationTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\NormalTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.68,0.00,0.00}{#1}}
\newcommand{\RegionMarkerTok}[1]{\textcolor[rgb]{0.00,0.23,0.31}{#1}}
\newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{#1}}
\newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\StringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\VariableTok}[1]{\textcolor[rgb]{0.07,0.07,0.07}{#1}}
\newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.13,0.47,0.30}{#1}}
\newcommand{\WarningTok}[1]{\textcolor[rgb]{0.37,0.37,0.37}{\textit{#1}}}

\providecommand{\tightlist}{%
  \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}\usepackage{longtable,booktabs,array}
\usepackage{calc} % for calculating minipage widths
% Correct order of tables after \paragraph or \subparagraph
\usepackage{etoolbox}
\makeatletter
\patchcmd\longtable{\par}{\if@noskipsec\mbox{}\fi\par}{}{}
\makeatother
% Allow footnotes in longtable head/foot
\IfFileExists{footnotehyper.sty}{\usepackage{footnotehyper}}{\usepackage{footnote}}
\makesavenoteenv{longtable}
\usepackage{graphicx}
\makeatletter
\def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth\else\Gin@nat@width\fi}
\def\maxheight{\ifdim\Gin@nat@height>\textheight\textheight\else\Gin@nat@height\fi}
\makeatother
% Scale images if necessary, so that they will not overflow the page
% margins by default, and it is still possible to overwrite the defaults
% using explicit options in \includegraphics[width, height, ...]{}
\setkeys{Gin}{width=\maxwidth,height=\maxheight,keepaspectratio}
% Set default figure placement to htbp
\makeatletter
\def\fps@figure{htbp}
\makeatother
% definitions for citeproc citations
\NewDocumentCommand\citeproctext{}{}
\NewDocumentCommand\citeproc{mm}{%
  \begingroup\def\citeproctext{#2}\cite{#1}\endgroup}
\makeatletter
 % allow citations to break across lines
 \let\@cite@ofmt\@firstofone
 % avoid brackets around text for \cite:
 \def\@biblabel#1{}
 \def\@cite#1#2{{#1\if@tempswa , #2\fi}}
\makeatother
\newlength{\cslhangindent}
\setlength{\cslhangindent}{1.5em}
\newlength{\csllabelwidth}
\setlength{\csllabelwidth}{3em}
\newenvironment{CSLReferences}[2] % #1 hanging-indent, #2 entry-spacing
 {\begin{list}{}{%
  \setlength{\itemindent}{0pt}
  \setlength{\leftmargin}{0pt}
  \setlength{\parsep}{0pt}
  % turn on hanging indent if param 1 is 1
  \ifodd #1
   \setlength{\leftmargin}{\cslhangindent}
   \setlength{\itemindent}{-1\cslhangindent}
  \fi
  % set entry spacing
  \setlength{\itemsep}{#2\baselineskip}}}
 {\end{list}}
\usepackage{calc}
\newcommand{\CSLBlock}[1]{\hfill\break\parbox[t]{\linewidth}{\strut\ignorespaces#1\strut}}
\newcommand{\CSLLeftMargin}[1]{\parbox[t]{\csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLRightInline}[1]{\parbox[t]{\linewidth - \csllabelwidth}{\strut#1\strut}}
\newcommand{\CSLIndent}[1]{\hspace{\cslhangindent}#1}

\KOMAoption{captions}{tableheading}
\makeatletter
\@ifpackageloaded{tcolorbox}{}{\usepackage[skins,breakable]{tcolorbox}}
\@ifpackageloaded{fontawesome5}{}{\usepackage{fontawesome5}}
\definecolor{quarto-callout-color}{HTML}{909090}
\definecolor{quarto-callout-note-color}{HTML}{0758E5}
\definecolor{quarto-callout-important-color}{HTML}{CC1914}
\definecolor{quarto-callout-warning-color}{HTML}{EB9113}
\definecolor{quarto-callout-tip-color}{HTML}{00A047}
\definecolor{quarto-callout-caution-color}{HTML}{FC5300}
\definecolor{quarto-callout-color-frame}{HTML}{acacac}
\definecolor{quarto-callout-note-color-frame}{HTML}{4582ec}
\definecolor{quarto-callout-important-color-frame}{HTML}{d9534f}
\definecolor{quarto-callout-warning-color-frame}{HTML}{f0ad4e}
\definecolor{quarto-callout-tip-color-frame}{HTML}{02b875}
\definecolor{quarto-callout-caution-color-frame}{HTML}{fd7e14}
\makeatother
\makeatletter
\@ifpackageloaded{bookmark}{}{\usepackage{bookmark}}
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\AtBeginDocument{%
\ifdefined\contentsname
  \renewcommand*\contentsname{Table of contents}
\else
  \newcommand\contentsname{Table of contents}
\fi
\ifdefined\listfigurename
  \renewcommand*\listfigurename{List of Figures}
\else
  \newcommand\listfigurename{List of Figures}
\fi
\ifdefined\listtablename
  \renewcommand*\listtablename{List of Tables}
\else
  \newcommand\listtablename{List of Tables}
\fi
\ifdefined\figurename
  \renewcommand*\figurename{Figure}
\else
  \newcommand\figurename{Figure}
\fi
\ifdefined\tablename
  \renewcommand*\tablename{Table}
\else
  \newcommand\tablename{Table}
\fi
}
\@ifpackageloaded{float}{}{\usepackage{float}}
\floatstyle{ruled}
\@ifundefined{c@chapter}{\newfloat{codelisting}{h}{lop}}{\newfloat{codelisting}{h}{lop}[chapter]}
\floatname{codelisting}{Listing}
\newcommand*\listoflistings{\listof{codelisting}{List of Listings}}
\makeatother
\makeatletter
\makeatother
\makeatletter
\@ifpackageloaded{caption}{}{\usepackage{caption}}
\@ifpackageloaded{subcaption}{}{\usepackage{subcaption}}
\makeatother
\ifLuaTeX
  \usepackage{selnolig}  % disable illegal ligatures
\fi
\usepackage{bookmark}

\IfFileExists{xurl.sty}{\usepackage{xurl}}{} % add URL line breaks if available
\urlstyle{same} % disable monospaced font for URLs
\hypersetup{
  pdftitle={Multilevel Multilingual},
  pdfauthor={Andrew Grogan-Kaylor},
  colorlinks=true,
  linkcolor={blue},
  filecolor={Maroon},
  citecolor={Blue},
  urlcolor={Blue},
  pdfcreator={LaTeX via pandoc}}

\title{Multilevel Multilingual}
\usepackage{etoolbox}
\makeatletter
\providecommand{\subtitle}[1]{% add subtitle to \maketitle
  \apptocmd{\@title}{\par {\large #1 \par}}{}{}
}
\makeatother
\subtitle{Multilevel Models in Stata, R and Julia}
\author{Andrew Grogan-Kaylor}
\date{2024-05-15}

\begin{document}
\maketitle

\renewcommand*\contentsname{Table of contents}
{
\hypersetup{linkcolor=}
\setcounter{tocdepth}{2}
\tableofcontents
}
\listoftables
\bookmarksetup{startatroot}

\chapter{Multilevel Multilingual}\label{multilevel-multilingual}

\begin{quote}
``This curious world which we inhabit is more wonderful than it is
convenient\ldots{}'' (Thoreau, 1975)
\end{quote}

\begin{quote}
``Mathematics is my secret. My secret weakness. I feel like a stubborn,
helpless fool in the middle of a problem. Trapped and crazed. Also,
thrilled.'' (Schanen, 2021)
\end{quote}

\section{Introduction}\label{introduction}

Below, I describe the use of \href{https://www.stata.com/}{Stata}
(StataCorp, 2021), \href{https://www.r-project.org/}{R} (Bates et al.,
2015; R Core Team, 2023), and \href{https://www.julialang.org/}{Julia}
(Bates, 2024; Bezanson et al., 2017) to estimate multilevel models.

All of these software packages can estimate multilevel models. However,
there are substantial differences between the different packages: Stata
is proprietary \emph{for cost} software, which is very well documented
and very intuitive. While it costs money to purchase Stata, the price is
often very reasonal for academic and educational use. R is free open
source software which is less intuitive, but there are many excellent
resources for learning R. There is often a cost associated with
purchasing books and other materials for learning R. Julia is newer open
source software, and ostensibly much faster than either Stata or R,
which may be an important advantage when running multilevel models with
very large data sets. At this point in time, both Stata and R feel much
more \emph{stable} than Julia which is still evolving software.

While any of these software packages can be used for learning and
estimating multilevel models, I will offer my own opinion--based upon 15
years of teaching multilevel models at the doctoral level--that Stata
offers the quickest pathway for learning the basic and advanced uses of
multilevel models. I also believe the intuitive nature of Stata syntax
contributes to accurate and replicable work in this area.

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.1667}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.1528}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.5417}}@{}}
\caption{Software for Multilevel
Modeling}\label{tbl-software}\tabularnewline
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Software
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Cost
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Ease of Use
\end{minipage} \\
\midrule\noalign{}
\endfirsthead
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Software
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Cost
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Ease of Use
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Stata & some cost & learning curve, but very intuitive for both
multilevel modeling and graphing. \\
R & free & learning curve: intuitive for multilevel modeling; but
steeper learning curve for graphing (\texttt{ggplot}). \\
Julia & free & steep learning curve in general: steep learning curve for
multilevel modeling; and very steep learning curve for graphing.
Graphics libraries are very much under development and in flux. \\
\end{longtable}

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-tip-color-frame, opacityback=0, breakable, bottomrule=.15mm, leftrule=.75mm, left=2mm, toprule=.15mm, title=\textcolor{quarto-callout-tip-color}{\faLightbulb}\hspace{0.5em}{Results Will Vary Somewhat}, colback=white, coltitle=black, arc=.35mm, bottomtitle=1mm, colbacktitle=quarto-callout-tip-color!10!white, toptitle=1mm, titlerule=0mm, rightrule=.15mm, opacitybacktitle=0.6]

Estimating multilevel models is a complex endeavor. The software details
of how this is accomplished are beyond the purview of this book. Suffice
it to say that across different software packages there will be
differences in estimation routines, resulting in some numerical
differences in the results provided by different software packages.
Substantively speaking, however, results should agree across software.

\end{tcolorbox}

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-tip-color-frame, opacityback=0, breakable, bottomrule=.15mm, leftrule=.75mm, left=2mm, toprule=.15mm, title=\textcolor{quarto-callout-tip-color}{\faLightbulb}\hspace{0.5em}{Multi-Line Commands}, colback=white, coltitle=black, arc=.35mm, bottomtitle=1mm, colbacktitle=quarto-callout-tip-color!10!white, toptitle=1mm, titlerule=0mm, rightrule=.15mm, opacitybacktitle=0.6]

Sometimes I have written commands out over multiple lines. I have done
this for especially long commands, but have also sometimes done this
simply for the sake of clarity. The different software packages have
different approaches to multi-line commands.

\begin{enumerate}
\def\labelenumi{\arabic{enumi}.}
\tightlist
\item
  By default, \emph{Stata} ends a command at the end of a line. If you
  are going to write a multi-line command you should use the
  \texttt{///} line continuation characters.
\item
  \emph{R} is the software that most naturally can be written using
  multiple lines, as R commands are usually clearly encased in
  parentheses (\texttt{()}) or continued with \texttt{+} signs.
\item
  Like \emph{Stata}, \emph{Julia} expects commands to end at the end of
  a line. If you are going to write a mult-line command, all commands
  except for the last line should end in a character that clearly
  indicates continuation, like a \texttt{+} sign. An alternative is to
  encase the entire Julia command in an outer set of parentheses
  (\texttt{()}).
\end{enumerate}

\end{tcolorbox}

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-tip-color-frame, opacityback=0, breakable, bottomrule=.15mm, leftrule=.75mm, left=2mm, toprule=.15mm, title=\textcolor{quarto-callout-tip-color}{\faLightbulb}\hspace{0.5em}{Running Statistical Packages in Quarto}, colback=white, coltitle=black, arc=.35mm, bottomtitle=1mm, colbacktitle=quarto-callout-tip-color!10!white, toptitle=1mm, titlerule=0mm, rightrule=.15mm, opacitybacktitle=0.6]

I used Quarto (\url{https://quarto.org/}) to create this Appendix.
Quarto is a programming and publishing environment that can run multiple
programming languages, including Stata, R and Julia, and that can write
to multiple output formats including HTML, PDF, and MS Word. To run
Stata, I used the \texttt{Statamarkdown} library in R to connect Stata
to Quarto. Quarto has a built in connection to R, and runs R without
issue. To run Julia, I used the \texttt{JuliaCall} library in R to
connect Quarto to Julia.

Of course, each of these programs can be run by itself, if you have them
installed on your computer.

\end{tcolorbox}

\section{The Data}\label{sec-data}

The examples use the \texttt{simulated\_multilevel\_data.dta} file from
\href{https://agrogan1.github.io/multilevel-thinking/simulated-multi-country-data.html}{\emph{Multilevel
Thinking}}. Here is a
\href{https://github.com/agrogan1/multilevel-multilingual/raw/main/simulated_multilevel_data.dta}{direct
link} to download the data.

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1266}}
  >{\centering\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.0759}}
  >{\centering\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1139}}
  >{\centering\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.0759}}
  >{\centering\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1392}}
  >{\centering\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.1899}}
  >{\centering\arraybackslash}p{(\columnwidth - 12\tabcolsep) * \real{0.2785}}@{}}

\caption{\label{tbl-multilingual1}Sample of Simulated Multilevel Data}

\tabularnewline

\caption{Table continues below}\tabularnewline
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
country
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
HDI
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
family
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
id
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
identity
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
intervention
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
physical\_punishment
\end{minipage} \\
\midrule\noalign{}
\endfirsthead
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
country
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
HDI
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
family
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
id
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
identity
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
intervention
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
physical\_punishment
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
1 & 69 & 1 & 1.1 & 2 & 0 & 3 \\
1 & 69 & 2 & 1.2 & 2 & 1 & 2 \\
1 & 69 & 3 & 1.3 & 1 & 1 & 3 \\
1 & 69 & 4 & 1.4 & 2 & 0 & 0 \\
1 & 69 & 5 & 1.5 & 2 & 0 & 4 \\
1 & 69 & 6 & 1.6 & 1 & 1 & 5 \\

\end{longtable}

\begin{longtable}[]{@{}
  >{\centering\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.1250}}
  >{\centering\arraybackslash}p{(\columnwidth - 2\tabcolsep) * \real{0.1389}}@{}}

\caption{\label{tbl-multilingual1}Sample of Simulated Multilevel Data}

\tabularnewline

\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\centering
warmth
\end{minipage} & \begin{minipage}[b]{\linewidth}\centering
outcome
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
3 & 57.47 \\
1 & 50.1 \\
2 & 52.92 \\
5 & 60.17 \\
4 & 55.05 \\
3 & 49.81 \\

\end{longtable}

\section{An Introduction To Equations and Syntax}\label{sec-syntax}

To explain statistical syntax for each software, I consider the general
case of a multilevel model with dependent variable \texttt{y},
independent variables \texttt{x} and \texttt{z}, clustering variable
\texttt{group}, and a random slope for \texttt{x}. \emph{i} is the index
for the person, while \emph{j} is the index for the \texttt{group}.

\begin{equation}\phantomsection\label{eq-MLMsimple}{y = \beta_0 + \beta_1 x_{ij} + \beta_2 z_{ij} + u_{0j} + u_{1j} \times x_{ij} + e_{ij}}\end{equation}

\subsection{Stata}

In Stata \texttt{mixed}, the syntax for a multilevel model of the form
described in Equation~\ref{eq-MLMsimple} is:

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mixed }\FunctionTok{y}\NormalTok{ x || }\FunctionTok{group}\NormalTok{: x}
\end{Highlighting}
\end{Shaded}

\subsection{R}

In R \texttt{lme4}, the general syntax for a multilevel model of the
form described in Equation~\ref{eq-MLMsimple} is:

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(lme4)}

\FunctionTok{lmer}\NormalTok{(y }\SpecialCharTok{\textasciitilde{}}\NormalTok{ x }\SpecialCharTok{+}\NormalTok{ z }\SpecialCharTok{+}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{+}\NormalTok{ x }\SpecialCharTok{||}\NormalTok{ group), }\AttributeTok{data =}\NormalTok{ ...)}
\end{Highlighting}
\end{Shaded}

\subsection{Julia}

In Julia \texttt{MixedModels}, the general syntax for a multilevel model
of the form described in Equation~\ref{eq-MLMsimple} is:

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{using} \BuiltInTok{MixedModels}

\FunctionTok{fit}\NormalTok{(MixedModel, }\PreprocessorTok{@formula}\NormalTok{(y }\OperatorTok{\textasciitilde{}}\NormalTok{ x }\OperatorTok{+}\NormalTok{ z }\OperatorTok{+}\NormalTok{ (}\FloatTok{1} \OperatorTok{+}\NormalTok{ x }\OperatorTok{|}\NormalTok{ group)), data)}
\end{Highlighting}
\end{Shaded}

\bookmarksetup{startatroot}

\chapter{Descriptive Statistics}\label{descriptive-statistics}

\section{Descriptive Statistics}\label{descriptive-statistics-1}

\subsection{Stata}

\begin{Shaded}
\begin{Highlighting}[]

\KeywordTok{use}\NormalTok{ simulated\_multilevel\_data.dta }\CommentTok{// use data}
\end{Highlighting}
\end{Shaded}

We use \texttt{summarize} for \emph{continuous} variables, and
\texttt{tabulate} for \emph{categorical} variables.

\begin{Shaded}
\begin{Highlighting}[]
\KeywordTok{summarize}\NormalTok{ outcome warmth physical\_punishment HDI}

\KeywordTok{tabulate} \KeywordTok{identity}

\KeywordTok{tabulate}\NormalTok{ intervention}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
     outcome |      3,000    52.43327    6.530996   29.60798   74.83553
      warmth |      3,000    3.521667    1.888399          0          7
physical_p~t |      3,000    2.478667    1.360942          0          5
         HDI |      3,000    64.76667    17.24562         33         87


hypothetica |
 l identity |
      group |
   variable |      Freq.     Percent        Cum.
------------+-----------------------------------
          1 |      1,507       50.23       50.23
          2 |      1,493       49.77      100.00
------------+-----------------------------------
      Total |      3,000      100.00


   recieved |
interventio |
          n |      Freq.     Percent        Cum.
------------+-----------------------------------
          0 |      1,547       51.57       51.57
          1 |      1,453       48.43      100.00
------------+-----------------------------------
      Total |      3,000      100.00
\end{verbatim}

\subsection{R}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(haven) }\CommentTok{\# read data in Stata format}

\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read\_dta}\NormalTok{(}\StringTok{"simulated\_multilevel\_data.dta"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

R's descriptive statistics functions rely heavily on whether a variable
is a \emph{numeric} variable, or a \emph{factor} variable. Below, I
convert two variables to factors (\texttt{factor}) before using
\texttt{summary}\footnote{\texttt{skimr} is an excellent new alternative
  library for generating descriptive statistics in R.} to generate
descriptive statistics.

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{df}\SpecialCharTok{$}\NormalTok{country }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{country)}

\NormalTok{df}\SpecialCharTok{$}\NormalTok{identity }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{identity)}

\NormalTok{df}\SpecialCharTok{$}\NormalTok{intervention }\OtherTok{\textless{}{-}} \FunctionTok{factor}\NormalTok{(df}\SpecialCharTok{$}\NormalTok{intervention)}

\FunctionTok{summary}\NormalTok{(df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
    country          HDI            family            id            identity
 1      : 100   Min.   :33.00   Min.   :  1.00   Length:3000        1:1507  
 2      : 100   1st Qu.:53.00   1st Qu.: 25.75   Class :character   2:1493  
 3      : 100   Median :70.00   Median : 50.50   Mode  :character           
 4      : 100   Mean   :64.77   Mean   : 50.50                              
 5      : 100   3rd Qu.:81.00   3rd Qu.: 75.25                              
 6      : 100   Max.   :87.00   Max.   :100.00                              
 (Other):2400                                                               
 intervention physical_punishment     warmth         outcome     
 0:1547       Min.   :0.000       Min.   :0.000   Min.   :29.61  
 1:1453       1st Qu.:2.000       1st Qu.:2.000   1st Qu.:48.02  
              Median :2.000       Median :4.000   Median :52.45  
              Mean   :2.479       Mean   :3.522   Mean   :52.43  
              3rd Qu.:3.000       3rd Qu.:5.000   3rd Qu.:56.86  
              Max.   :5.000       Max.   :7.000   Max.   :74.84  
                                                                 
\end{verbatim}

\subsection{Julia}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{using} \BuiltInTok{Tables}\NormalTok{, }\BuiltInTok{MixedModels}\NormalTok{, }\BuiltInTok{MixedModelsExtras}\NormalTok{, }\BuiltInTok{StatFiles}\NormalTok{, }\BuiltInTok{DataFrames}\NormalTok{, }\BuiltInTok{CategoricalArrays}\NormalTok{, }\BuiltInTok{DataFramesMeta}

\NormalTok{df }\OperatorTok{=} \FunctionTok{DataFrame}\NormalTok{(}\FunctionTok{load}\NormalTok{(}\StringTok{"simulated\_multilevel\_data.dta"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

Similarly to R, Julia relies on the idea of \emph{variable type}. I use
\texttt{transform} to convert the appropriate variables to
\emph{categorical} variables.

\begin{Shaded}
\begin{Highlighting}[]
\PreprocessorTok{@transform}\NormalTok{!(df, }\OperatorTok{:}\NormalTok{country }\OperatorTok{=} \FunctionTok{categorical}\NormalTok{(}\OperatorTok{:}\NormalTok{country))}

\PreprocessorTok{@transform}\NormalTok{!(df, }\OperatorTok{:}\NormalTok{identity }\OperatorTok{=} \FunctionTok{categorical}\NormalTok{(}\OperatorTok{:}\NormalTok{identity))}

\PreprocessorTok{@transform}\NormalTok{!(df, }\OperatorTok{:}\NormalTok{intervention }\OperatorTok{=} \FunctionTok{categorical}\NormalTok{(}\OperatorTok{:}\NormalTok{intervention))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{describe}\NormalTok{(df) }\CommentTok{\# descriptive statistics}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
9×7 DataFrame
 Row │ variable             mean     min     median  max      nmissing  eltype ⋯
     │ Symbol               Union…   Any     Union…  Any      Int64     Union  ⋯
─────┼──────────────────────────────────────────────────────────────────────────
   1 │ country                       1.0             30.0            0  Union{ ⋯
   2 │ HDI                  64.7667  33.0    70.0    87.0            0  Union{
   3 │ family               50.5     1.0     50.5    100.0           0  Union{
   4 │ id                            1.1             9.99            0  Union{
   5 │ identity                      1.0             2.0             0  Union{ ⋯
   6 │ intervention                  0.0             1.0             0  Union{
   7 │ physical_punishment  2.47867  0.0     2.0     5.0             0  Union{
   8 │ warmth               3.52167  0.0     4.0     7.0             0  Union{
   9 │ outcome              52.4333  29.608  52.449  74.8355         0  Union{ ⋯
                                                                1 column omitted
\end{verbatim}

\section{Interpretation}\label{interpretation}

Examining descriptive statistics is an important first step in any
analysis. It is important to examine your descriptive statistics first,
before skipping ahead to more sophisticated analyses, such as multilevel
models.

In examining the descriptive statistics for this data, we get a sense of
the data.

\begin{itemize}
\tightlist
\item
  \texttt{outcome} has a mean of approximately 52 and ranges from
  approximately 30 to 75.
\item
  \texttt{warmth} and \texttt{physical\ punishment} are both variables
  that represent the number of times that parents use each of these
  forms of discipline in a week. The average of the former is about 3.5,
  while the average of the latter is about 2.5.
\item
  \texttt{HDI}, the Human Development Index has an average of about 65,
  and a wide range.
\item
  \texttt{identity} is a categorical variable for a hypothetical
  identity group, and has values of 1 and 2.
\item
  \texttt{intervention} is also a categorical variable, and has values
  of 0 and 1.
\end{itemize}

\bookmarksetup{startatroot}

\chapter{Unconditional Model}\label{unconditional-model}

An \emph{unconditional} multilevel model is a model with no independent
variables. One should always run an unconditional model as the first
step of a multilevel model in order to get a sense of the way that
variation is apportioned in the model across the different levels.

\section{The Equation}\label{the-equation}

\begin{equation}\phantomsection\label{eq-MLMunconditional}{\text{outcome}_{ij}= \beta_0 + u_{0j} + e_{ij}}\end{equation}

The Intraclass Correlation Coefficient (ICC) is given by:

\begin{equation}\phantomsection\label{eq-ICCunconditional}{\text{ICC} = \frac{var(u_{0j})}{var(u_{0j}) + var(e_{ij})}}\end{equation}

In a two level multilevel model, the ICC provides a measure of the
amount of variation attributable to Level 2.

\section{Run Models}\label{run-models}

\subsection{Stata}

\begin{Shaded}
\begin{Highlighting}[]

\KeywordTok{use}\NormalTok{ simulated\_multilevel\_data.dta }\CommentTok{// use data}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]

\NormalTok{mixed outcome || country: }\CommentTok{// unconditional model}
  
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Performing EM optimization ...

Performing gradient-based optimization: 
Iteration 0:  Log likelihood = -9802.8371  
Iteration 1:  Log likelihood = -9802.8371  

Computing standard errors ...

Mixed-effects ML regression                           Number of obs    = 3,000
Group variable: country                               Number of groups =    30
                                                      Obs per group:
                                                                   min =   100
                                                                   avg = 100.0
                                                                   max =   100
                                                      Wald chi2(0)     =     .
Log likelihood = -9802.8371                           Prob > chi2      =     .

------------------------------------------------------------------------------
     outcome | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
-------------+----------------------------------------------------------------
       _cons |   52.43327   .3451217   151.93   0.000     51.75685     53.1097
------------------------------------------------------------------------------

------------------------------------------------------------------------------
  Random-effects parameters  |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
country: Identity            |
                  var(_cons) |   3.178658   .9226737      1.799552    5.614658
-----------------------------+------------------------------------------------
               var(Residual) |   39.46106   1.024013      37.50421       41.52
------------------------------------------------------------------------------
LR test vs. linear model: chibar2(01) = 166.31        Prob >= chibar2 = 0.0000
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
  
\KeywordTok{estat}\NormalTok{ icc }\CommentTok{// ICC}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Intraclass correlation

------------------------------------------------------------------------------
                       Level |        ICC   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
                     country |   .0745469   .0201254      .0434963    .1248696
------------------------------------------------------------------------------
\end{verbatim}

\subsection{R}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(haven)}

\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read\_dta}\NormalTok{(}\StringTok{"simulated\_multilevel\_data.dta"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(lme4) }\CommentTok{\# estimate multilevel models}

\NormalTok{fit0 }\OtherTok{\textless{}{-}} \FunctionTok{lmer}\NormalTok{(outcome }\SpecialCharTok{\textasciitilde{}}\NormalTok{ (}\DecValTok{1} \SpecialCharTok{|}\NormalTok{ country),}
             \AttributeTok{data =}\NormalTok{ df) }\CommentTok{\# unconditional model}

\FunctionTok{summary}\NormalTok{(fit0)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Linear mixed model fit by REML ['lmerMod']
Formula: outcome ~ (1 | country)
   Data: df

REML criterion at convergence: 19605.9

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.3844 -0.6655 -0.0086  0.6725  3.6626 

Random effects:
 Groups   Name        Variance Std.Dev.
 country  (Intercept)  3.302   1.817   
 Residual             39.461   6.282   
Number of obs: 3000, groups:  country, 30

Fixed effects:
            Estimate Std. Error t value
(Intercept)   52.433      0.351   149.4
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(performance)}

\NormalTok{performance}\SpecialCharTok{::}\FunctionTok{icc}\NormalTok{(fit0) }\CommentTok{\# ICC}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
# Intraclass Correlation Coefficient

    Adjusted ICC: 0.077
  Unadjusted ICC: 0.077
\end{verbatim}

\subsection{Julia}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{using} \BuiltInTok{Tables}\NormalTok{, }\BuiltInTok{MixedModels}\NormalTok{, }\BuiltInTok{MixedModelsExtras}\NormalTok{, }
\BuiltInTok{StatFiles}\NormalTok{, }\BuiltInTok{DataFrames}\NormalTok{, }\BuiltInTok{CategoricalArrays}\NormalTok{, }\BuiltInTok{DataFramesMeta}

\NormalTok{df }\OperatorTok{=} \FunctionTok{DataFrame}\NormalTok{(}\FunctionTok{load}\NormalTok{(}\StringTok{"simulated\_multilevel\_data.dta"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]
\PreprocessorTok{@transform}\NormalTok{!(df, }\OperatorTok{:}\NormalTok{country }\OperatorTok{=} \FunctionTok{categorical}\NormalTok{(}\OperatorTok{:}\NormalTok{country))}
\end{Highlighting}
\end{Shaded}

\begin{Shaded}
\begin{Highlighting}[]

\NormalTok{m0 }\OperatorTok{=} \FunctionTok{fit}\NormalTok{(MixedModel, }
         \PreprocessorTok{@formula}\NormalTok{(outcome }\OperatorTok{\textasciitilde{}}\NormalTok{ (}\FloatTok{1} \OperatorTok{|}\NormalTok{ country)), df) }\CommentTok{\# unconditional model}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Linear mixed model fit by maximum likelihood
 outcome ~ 1 + (1 | country)
   logLik   -2 logLik     AIC       AICc        BIC    
 -9802.8371 19605.6742 19611.6742 19611.6822 19629.6933

Variance components:
            Column   Variance Std.Dev.
country  (Intercept)   3.17863 1.78287
Residual              39.46106 6.28180
 Number of obs: 3000; levels of grouping factors: 30

  Fixed-effects parameters:
──────────────────────────────────────────────────
               Coef.  Std. Error       z  Pr(>|z|)
──────────────────────────────────────────────────
(Intercept)  52.4333    0.345121  151.93    <1e-99
──────────────────────────────────────────────────
\end{verbatim}

\begin{Shaded}
\begin{Highlighting}[]

\FunctionTok{icc}\NormalTok{(m0) }\CommentTok{\# ICC}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
0.07454637475695493
\end{verbatim}

\section{Interpretation}\label{interpretation-1}

In each case, the software finds that nearly 8\% of the variation in the
outcome is explainable by the clustering of the observations in each
country.

\bookmarksetup{startatroot}

\chapter{Cross Sectional Multilevel
Models}\label{cross-sectional-multilevel-models}

\section{The Equation}\label{the-equation-1}

Recall the general model of Equation~\ref{eq-MLMsimple}, and the syntax
outlined in Section~\ref{sec-syntax}. Below in
Equation~\ref{eq-MLMsubstantive}, we consider a more substantive
example.

\begin{equation}\phantomsection\label{eq-MLMsubstantive}{\text{outcome}_{ij}= \beta_0 + \beta_1 \text{warmth}_{ij} +}\end{equation}

\[\beta_2 \text{physical punishment}_{ij} +\]

\[\beta_3 \text{identity}_{ij} + \beta_4 \text{intervention}_{ij} + \beta_5 \text{HDI}_{ij} +\]

\[u_{0j} + u_{1j} \times \text{warmth}_{ij} + e_{ij}\]

\section{Correlated and Uncorrelated Random
Effects}\label{correlated-and-uncorrelated-random-effects}

Consider the covariance matrix of random effects (e.g.~\(u_{0j}\) and
\(u_{1j}\)). In Equation~\ref{eq-varcovar} the covariances of the random
effects are constrained to be zero.

\begin{equation}\phantomsection\label{eq-varcovar}{\begin{bmatrix}
var(u_{0j}) & 0 \\
0 & var(u_{1j}) 
\end{bmatrix}}\end{equation}

As discussed in the Chapter on multilevel models with cross-sectional
data, however, one can consider a multilevel model in which the random
effects are correlated, as is the case in Equation~\ref{eq-varcovaruns}.

\begin{equation}\phantomsection\label{eq-varcovaruns}{\begin{bmatrix}
var(u_{0j}) & cov(u_{0j}, u_{1j}) \\
cov(u_{0j}, u_{1j}) & var(u_{1j}) 
\end{bmatrix}}\end{equation}

Procedures for estimating models with uncorrelated and correlated random
effects are detailed below (Bates et al., 2015; Bates, 2024; StataCorp,
2021).

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.1667}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3056}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3889}}@{}}
\caption{Correlated and Uncorrelated Random
Effects}\label{tbl-REs}\tabularnewline
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Software
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Uncorrelated Random Effects
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Correlated Random Effects
\end{minipage} \\
\midrule\noalign{}
\endfirsthead
\toprule\noalign{}
\begin{minipage}[b]{\linewidth}\raggedright
Software
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Uncorrelated Random Effects
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Correlated Random Effects
\end{minipage} \\
\midrule\noalign{}
\endhead
\bottomrule\noalign{}
\endlastfoot
Stata & default & add option: \texttt{,\ cov(uns)} \\
R & separate random effects from grouping variable with
\texttt{\textbar{}\textbar{}} & separate random effects from grouping
variable with \texttt{\textbar{}} \\
Julia & separate terms for each random effect e.g.
\texttt{(1\ \textbar{}\ group)\ +} \texttt{(0\ +\ x\ \textbar{}\ group)}
& separate random effects from grouping variable with
\texttt{\textbar{}}. \\
\end{longtable}

All models in the examples below are run with \emph{uncorrelated} random
effects, but could just as easily be run with \emph{correlated} random
effects.

\section{Run Models}\label{run-models-1}

\subsection{Stata}

\subsubsection{Get The Data}\label{get-the-data}

\begin{Shaded}
\begin{Highlighting}[]

\KeywordTok{use}\NormalTok{ simulated\_multilevel\_data.dta}
\end{Highlighting}
\end{Shaded}

\subsubsection{Run The Model}\label{run-the-model}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mixed outcome warmth physical\_punishment i.}\KeywordTok{identity}\NormalTok{ i.intervention HDI || country: warmth}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Performing EM optimization ...

Performing gradient-based optimization: 
Iteration 0:  Log likelihood = -9626.6279  
Iteration 1:  Log likelihood =  -9626.607  
Iteration 2:  Log likelihood =  -9626.607  

Computing standard errors ...

Mixed-effects ML regression                          Number of obs    =  3,000
Group variable: country                              Number of groups =     30
                                                     Obs per group:
                                                                  min =    100
                                                                  avg =  100.0
                                                                  max =    100
                                                     Wald chi2(5)     = 334.14
Log likelihood =  -9626.607                          Prob > chi2      = 0.0000

-------------------------------------------------------------------------------------
            outcome | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
--------------------+----------------------------------------------------------------
             warmth |   .8345368   .0637213    13.10   0.000     .7096453    .9594282
physical_punishment |  -.9916657   .0797906   -12.43   0.000    -1.148052   -.8352791
         2.identity |  -.3004767   .2170295    -1.38   0.166    -.7258466    .1248933
     1.intervention |   .6396427   .2174519     2.94   0.003     .2134448    1.065841
                HDI |   -.003228   .0199257    -0.16   0.871    -.0422817    .0358256
              _cons |   51.99991   1.371257    37.92   0.000      49.3123    54.68753
-------------------------------------------------------------------------------------

------------------------------------------------------------------------------
  Random-effects parameters  |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
country: Independent         |
                 var(warmth) |   .0227504   .0257784      .0024689    .2096436
                  var(_cons) |   2.963975   .9737647      1.556777    5.643163
-----------------------------+------------------------------------------------
               var(Residual) |   34.97499   .9097109      33.23668    36.80422
------------------------------------------------------------------------------
LR test vs. linear model: chi2(2) = 205.74                Prob > chi2 = 0.0000

Note: LR test is conservative and provided only for reference.
\end{verbatim}

\subsection{R}

\subsubsection{Get The Data}\label{get-the-data-1}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(haven)}

\NormalTok{df }\OtherTok{\textless{}{-}} \FunctionTok{read\_dta}\NormalTok{(}\StringTok{"simulated\_multilevel\_data.dta"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsubsection{Run The Model}\label{run-the-model-1}

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-caution-color-frame, opacityback=0, breakable, bottomrule=.15mm, leftrule=.75mm, left=2mm, toprule=.15mm, title=\textcolor{quarto-callout-caution-color}{\faFire}\hspace{0.5em}{Caution}, colback=white, coltitle=black, arc=.35mm, bottomtitle=1mm, colbacktitle=quarto-callout-caution-color!10!white, toptitle=1mm, titlerule=0mm, rightrule=.15mm, opacitybacktitle=0.6]

\texttt{lme4} does not directly provide p values in results, because of
some disagreement over exactly how these p values should be calculated.
Therefore, in this Appendix, I also call library \texttt{lmerTest} to
provide p values for \texttt{lme4} results.

\end{tcolorbox}

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-tip-color-frame, opacityback=0, breakable, bottomrule=.15mm, leftrule=.75mm, left=2mm, toprule=.15mm, title=\textcolor{quarto-callout-tip-color}{\faLightbulb}\hspace{0.5em}{Tip}, colback=white, coltitle=black, arc=.35mm, bottomtitle=1mm, colbacktitle=quarto-callout-tip-color!10!white, toptitle=1mm, titlerule=0mm, rightrule=.15mm, opacitybacktitle=0.6]

R prefers to use scientific notation when possible. I find that the use
of scientific notation can be confusing in reading results. I turn off
scientific notation by setting a penalty for its use:
\texttt{options(scipen\ =\ 999)}.

\end{tcolorbox}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(lme4) }

\FunctionTok{library}\NormalTok{(lmerTest)}

\FunctionTok{options}\NormalTok{(}\AttributeTok{scipen =} \DecValTok{999}\NormalTok{) }

\NormalTok{fit1 }\OtherTok{\textless{}{-}} \FunctionTok{lmer}\NormalTok{(outcome }\SpecialCharTok{\textasciitilde{}}\NormalTok{ warmth }\SpecialCharTok{+}\NormalTok{ physical\_punishment }\SpecialCharTok{+} 
\NormalTok{               identity }\SpecialCharTok{+}\NormalTok{ intervention }\SpecialCharTok{+}\NormalTok{ HDI }\SpecialCharTok{+}
\NormalTok{               (}\DecValTok{1} \SpecialCharTok{+}\NormalTok{ warmth }\SpecialCharTok{||}\NormalTok{ country),}
             \AttributeTok{data =}\NormalTok{ df)}

\FunctionTok{summary}\NormalTok{(fit1)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: outcome ~ warmth + physical_punishment + identity + intervention +  
    HDI + (1 + warmth || country)
   Data: df

REML criterion at convergence: 19268.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.9774 -0.6563  0.0187  0.6645  3.6730 

Random effects:
 Groups    Name        Variance Std.Dev.
 country   (Intercept)  3.19056 1.786   
 country.1 warmth       0.02465 0.157   
 Residual              35.01782 5.918   
Number of obs: 3000, groups:  country, 30

Fixed effects:
                       Estimate  Std. Error          df t value
(Intercept)           52.311714    1.446735   33.113738  36.158
warmth                 0.834562    0.064252   41.896966  12.989
physical_punishment   -0.991892    0.079845 2968.010901 -12.423
identity              -0.300350    0.217179 2970.106304  -1.383
intervention           0.639059    0.217603 2971.185215   2.937
HDI                   -0.003395    0.020596   27.598517  -0.165
                                Pr(>|t|)    
(Intercept)         < 0.0000000000000002 ***
warmth              0.000000000000000277 ***
physical_punishment < 0.0000000000000002 ***
identity                         0.16678    
intervention                     0.00334 ** 
HDI                              0.87027    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) warmth physc_ idntty intrvn
warmth      -0.119                            
physcl_pnsh -0.145 -0.003                     
identity    -0.220 -0.012 -0.003              
interventin -0.077  0.034  0.022 -0.018       
HDI         -0.922 -0.006  0.009 -0.001  0.000
\end{verbatim}

\subsection{Julia}

\subsubsection{Get The Data}\label{get-the-data-2}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{using} \BuiltInTok{Tables}\NormalTok{, }\BuiltInTok{MixedModels}\NormalTok{, }\BuiltInTok{StatFiles}\NormalTok{, }\BuiltInTok{DataFrames}\NormalTok{, }\BuiltInTok{CategoricalArrays}\NormalTok{, }\BuiltInTok{DataFramesMeta}

\NormalTok{df }\OperatorTok{=} \FunctionTok{DataFrame}\NormalTok{(}\FunctionTok{load}\NormalTok{(}\StringTok{"simulated\_multilevel\_data.dta"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\subsubsection{Change Country To
Categorical}\label{change-country-to-categorical}

\begin{Shaded}
\begin{Highlighting}[]
\PreprocessorTok{@transform}\NormalTok{!(df, }\OperatorTok{:}\NormalTok{country }\OperatorTok{=} \FunctionTok{categorical}\NormalTok{(}\OperatorTok{:}\NormalTok{country))}
\end{Highlighting}
\end{Shaded}

\subsubsection{Run The Model}\label{run-the-model-2}

\begin{Shaded}
\begin{Highlighting}[]

\NormalTok{m1 }\OperatorTok{=} \FunctionTok{fit}\NormalTok{(MixedModel, }\PreprocessorTok{@formula}\NormalTok{(outcome }\OperatorTok{\textasciitilde{}}\NormalTok{ warmth }\OperatorTok{+}\NormalTok{ physical\_punishment }\OperatorTok{+} 
\NormalTok{               identity }\OperatorTok{+}\NormalTok{ intervention }\OperatorTok{+}\NormalTok{ HDI }\OperatorTok{+}
\NormalTok{               (}\FloatTok{1} \OperatorTok{|}\NormalTok{ country) }\OperatorTok{+}
\NormalTok{               (}\FloatTok{0} \OperatorTok{+}\NormalTok{ warmth }\OperatorTok{|}\NormalTok{ country)), df)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Linear mixed model fit by maximum likelihood
 outcome ~ 1 + warmth + physical_punishment + identity + intervention + HDI + (1 | country) + (0 + warmth | country)
   logLik   -2 logLik     AIC       AICc        BIC    
 -9626.6070 19253.2140 19271.2140 19271.2742 19325.2713

Variance components:
            Column    Variance Std.Dev.   Corr.
country  (Intercept)   2.963849 1.721583
         warmth        0.022756 0.150852   .  
Residual              34.974984 5.913965
 Number of obs: 3000; levels of grouping factors: 30

  Fixed-effects parameters:
─────────────────────────────────────────────────────────────
                          Coef.  Std. Error       z  Pr(>|z|)
─────────────────────────────────────────────────────────────
(Intercept)          52.3004      1.40406     37.25    <1e-99
warmth                0.834537    0.0637228   13.10    <1e-38
physical_punishment  -0.991665    0.0797906  -12.43    <1e-34
identity             -0.300475    0.217029    -1.38    0.1662
intervention          0.639641    0.217452     2.94    0.0033
HDI                  -0.0032286   0.0199255   -0.16    0.8713
─────────────────────────────────────────────────────────────
\end{verbatim}

\section{Interpretation}\label{interpretation-2}

Models suggest that parental warmth is associated with increases in the
beneficial outcome, while physical punishment is associated with
decreases in the beneficial outcome. Membership in the group represented
by \texttt{identity} is not associated with the outcome. The
intervention is associated with increases in the outcome. The Human
Development Index is not associated with the outcome.

\bookmarksetup{startatroot}

\chapter{Longitudinal Multilevel
Models}\label{longitudinal-multilevel-models}

\section{The Data}\label{the-data}

The data employed in these examples are a longitudinal extension of the
data described in Section~\ref{sec-data}.

\section{The Equation}\label{the-equation-2}

\begin{equation}\phantomsection\label{eq-MLM-longitudinal}{\text{outcome}_{itj} = \beta_0 + \beta_1 \text{parental warmth}_{itj} + \beta_2 \text{physical punishment}_{itj} + \beta_3 \text{time}_{itj} \ + }\end{equation}

\[\beta_4 \text{identity}_{itj} + \beta_5 \text{intervention}_{itj} + \beta_6 \text{HDI}_{itj} +\]

\[u_{0j} + u_{1j} \times \text{parental warmth}_{itj} \ + \]

\[v_{0i} + v_{1i} \times \text{time}_{itj} + e_{itj}\]

\section{Run Models}\label{run-models-2}

\subsection{Stata}

\subsubsection{Get The Data}\label{get-the-data-3}

\begin{Shaded}
\begin{Highlighting}[]

\KeywordTok{use}\NormalTok{ simulated\_multilevel\_longitudinal\_data.dta}
\end{Highlighting}
\end{Shaded}

\subsubsection{Run The Model}\label{run-the-model-3}

\paragraph{Main Effects Only}\label{main-effects-only}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mixed outcome t warmth physical\_punishment i.}\KeywordTok{identity}\NormalTok{ i.intervention HDI || country: warmth}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Performing EM optimization ...

Performing gradient-based optimization: 
Iteration 0:  Log likelihood = -28739.506  
Iteration 1:  Log likelihood = -28739.506  

Computing standard errors ...

Mixed-effects ML regression                         Number of obs    =   9,000
Group variable: country                             Number of groups =      30
                                                    Obs per group:
                                                                 min =     300
                                                                 avg =   300.0
                                                                 max =     300
                                                    Wald chi2(6)     = 1119.81
Log likelihood = -28739.506                         Prob > chi2      =  0.0000

-------------------------------------------------------------------------------------
            outcome | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
--------------------+----------------------------------------------------------------
                  t |   .9443446   .0756408    12.48   0.000     .7960914    1.092598
             warmth |   .9123903   .0430042    21.22   0.000     .8281035     .996677
physical_punishment |  -.9881587   .0451732   -21.87   0.000    -1.076696   -.8996209
         2.identity |  -.1241465   .1242225    -1.00   0.318     -.367618    .1193251
     1.intervention |   .8575839   .1245179     6.89   0.000     .6135332    1.101635
                HDI |  -.0025173   .0191696    -0.13   0.896    -.0400891    .0350544
              _cons |   50.54528   1.304146    38.76   0.000      47.9892    53.10136
-------------------------------------------------------------------------------------

------------------------------------------------------------------------------
  Random-effects parameters  |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
country: Independent         |
                 var(warmth) |   .0229349   .0135353      .0072136    .0729194
                  var(_cons) |     3.0009   .8550708      1.716768    5.245553
-----------------------------+------------------------------------------------
               var(Residual) |   34.31935   .5130963       33.3283    35.33988
------------------------------------------------------------------------------
LR test vs. linear model: chi2(2) = 767.22                Prob > chi2 = 0.0000

Note: LR test is conservative and provided only for reference.
\end{verbatim}

\paragraph{Interactions With Time}\label{interactions-with-time}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{mixed outcome c.t\#\#(c.warmth c.physical\_punishment i.}\KeywordTok{identity}\NormalTok{ i.intervention c.HDI) || country: warmth}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Performing EM optimization ...

Performing gradient-based optimization: 
Iteration 0:  Log likelihood = -28738.554  
Iteration 1:  Log likelihood = -28738.554  

Computing standard errors ...

Mixed-effects ML regression                         Number of obs    =   9,000
Group variable: country                             Number of groups =      30
                                                    Obs per group:
                                                                 min =     300
                                                                 avg =   300.0
                                                                 max =     300
                                                    Wald chi2(11)    = 1122.75
Log likelihood = -28738.554                         Prob > chi2      =  0.0000

---------------------------------------------------------------------------------------
              outcome | Coefficient  Std. err.      z    P>|z|     [95% conf. interval]
----------------------+----------------------------------------------------------------
                    t |   .7537359   .3719996     2.03   0.043     .0246301    1.482842
               warmth |   .8198365   .0911059     9.00   0.000     .6412723    .9984008
  physical_punishment |  -1.000348   .1198049    -8.35   0.000    -1.235162   -.7655353
           2.identity |  -.2340191   .3271243    -0.72   0.474     -.875171    .4071327
       1.intervention |   .6597456   .3275877     2.01   0.044     .0176856    1.301806
                  HDI |  -.0005531   .0210866    -0.03   0.979     -.041882    .0407757
                      |
         c.t#c.warmth |   .0463746   .0402459     1.15   0.249    -.0325059    .1252551
                      |
                  c.t#|
c.physical_punishment |   .0061255   .0551491     0.11   0.912    -.1019647    .1142157
                      |
         identity#c.t |
                   2  |   .0548965   .1513015     0.36   0.717     -.241649    .3514421
                      |
     intervention#c.t |
                   1  |   .0990704    .151503     0.65   0.513      -.19787    .3960108
                      |
            c.t#c.HDI |  -.0009791   .0043888    -0.22   0.823    -.0095811    .0076229
                      |
                _cons |   50.92503   1.494157    34.08   0.000     47.99654    53.85352
---------------------------------------------------------------------------------------

------------------------------------------------------------------------------
  Random-effects parameters  |   Estimate   Std. err.     [95% conf. interval]
-----------------------------+------------------------------------------------
country: Independent         |
                 var(warmth) |   .0228292   .0135078      .0071588    .0728013
                  var(_cons) |   3.001849   .8552796       1.71738    5.247001
-----------------------------+------------------------------------------------
               var(Residual) |   34.31227   .5129896      33.32141    35.33258
------------------------------------------------------------------------------
LR test vs. linear model: chi2(2) = 767.35                Prob > chi2 = 0.0000

Note: LR test is conservative and provided only for reference.
\end{verbatim}

\subsection{R}

\subsubsection{Get The Data}\label{get-the-data-4}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(haven)}

\NormalTok{dfL }\OtherTok{\textless{}{-}} \FunctionTok{read\_dta}\NormalTok{(}\StringTok{"simulated\_multilevel\_longitudinal\_data.dta"}\NormalTok{)}
\end{Highlighting}
\end{Shaded}

\subsubsection{Run The Model}\label{run-the-model-4}

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-caution-color-frame, opacityback=0, breakable, bottomrule=.15mm, leftrule=.75mm, left=2mm, toprule=.15mm, title=\textcolor{quarto-callout-caution-color}{\faFire}\hspace{0.5em}{Caution}, colback=white, coltitle=black, arc=.35mm, bottomtitle=1mm, colbacktitle=quarto-callout-caution-color!10!white, toptitle=1mm, titlerule=0mm, rightrule=.15mm, opacitybacktitle=0.6]

\texttt{lme4} does not directly provide p values in results, because of
some disagreement over exactly how these p values should be calculated.
Therefore, in this Appendix, I also call library \texttt{lmerTest} to
provide p values for \texttt{lme4} results.

\end{tcolorbox}

\begin{tcolorbox}[enhanced jigsaw, colframe=quarto-callout-tip-color-frame, opacityback=0, breakable, bottomrule=.15mm, leftrule=.75mm, left=2mm, toprule=.15mm, title=\textcolor{quarto-callout-tip-color}{\faLightbulb}\hspace{0.5em}{Tip}, colback=white, coltitle=black, arc=.35mm, bottomtitle=1mm, colbacktitle=quarto-callout-tip-color!10!white, toptitle=1mm, titlerule=0mm, rightrule=.15mm, opacitybacktitle=0.6]

R prefers to use scientific notation when possible. I find that the use
of scientific notation can be confusing in reading results. I turn off
scientific notation by setting a penalty for its use:
\texttt{options(scipen\ =\ 999)}.

\end{tcolorbox}

\paragraph{Main Effects Only}\label{main-effects-only-1}

\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{library}\NormalTok{(lme4) }

\FunctionTok{library}\NormalTok{(lmerTest)}

\FunctionTok{options}\NormalTok{(}\AttributeTok{scipen =} \DecValTok{999}\NormalTok{) }

\NormalTok{fit2A }\OtherTok{\textless{}{-}} \FunctionTok{lmer}\NormalTok{(outcome }\SpecialCharTok{\textasciitilde{}}\NormalTok{ t }\SpecialCharTok{+}\NormalTok{ warmth }\SpecialCharTok{+}\NormalTok{ physical\_punishment }\SpecialCharTok{+} 
\NormalTok{               identity }\SpecialCharTok{+}\NormalTok{ intervention }\SpecialCharTok{+}\NormalTok{ HDI }\SpecialCharTok{+}
\NormalTok{               (}\DecValTok{1} \SpecialCharTok{|}\NormalTok{ country}\SpecialCharTok{/}\NormalTok{id),}
             \AttributeTok{data =}\NormalTok{ dfL)}

\FunctionTok{summary}\NormalTok{(fit2A)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: 
outcome ~ t + warmth + physical_punishment + identity + intervention +  
    HDI + (1 | country/id)
   Data: dfL

REML criterion at convergence: 57022.7

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.6850 -0.6094 -0.0035  0.6133  3.6792 

Random effects:
 Groups     Name        Variance Std.Dev.
 id:country (Intercept)  8.438   2.905   
 country    (Intercept)  3.675   1.917   
 Residual               26.036   5.103   
Number of obs: 9000, groups:  id:country, 3000; country, 30

Fixed effects:
                        Estimate   Std. Error           df t value
(Intercept)           50.5161891    1.4296454   31.1737942  35.335
t                      0.9433806    0.0658755 5998.3764616  14.321
warmth                 0.9140307    0.0379336 4745.3496835  24.096
physical_punishment   -1.0087537    0.0497972 6483.6770989 -20.257
identity              -0.1319548    0.1517350 2968.7829265  -0.870
intervention           0.8591494    0.1520510 2971.8112001   5.650
HDI                    0.0007909    0.0207656   28.0001836   0.038
                                Pr(>|t|)    
(Intercept)         < 0.0000000000000002 ***
t                   < 0.0000000000000002 ***
warmth              < 0.0000000000000002 ***
physical_punishment < 0.0000000000000002 ***
identity                           0.385    
intervention                0.0000000175 ***
HDI                                0.970    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) t      warmth physc_ idntty intrvn
t           -0.091                                   
warmth      -0.088 -0.002                            
physcl_pnsh -0.090 -0.007 -0.012                     
identity    -0.156  0.000 -0.013 -0.003              
interventin -0.055  0.000  0.039  0.019 -0.018       
HDI         -0.941  0.000 -0.004  0.005  0.000  0.002
\end{verbatim}

\paragraph{Interactions With Time}\label{interactions-with-time-1}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{fit2B }\OtherTok{\textless{}{-}} \FunctionTok{lmer}\NormalTok{(outcome }\SpecialCharTok{\textasciitilde{}}\NormalTok{ t }\SpecialCharTok{*}\NormalTok{(warmth }\SpecialCharTok{+}\NormalTok{ physical\_punishment }\SpecialCharTok{+} 
\NormalTok{               identity }\SpecialCharTok{+}\NormalTok{ intervention }\SpecialCharTok{+}\NormalTok{ HDI) }\SpecialCharTok{+}
\NormalTok{               (}\DecValTok{1} \SpecialCharTok{|}\NormalTok{ country}\SpecialCharTok{/}\NormalTok{id),}
             \AttributeTok{data =}\NormalTok{ dfL)}

\FunctionTok{summary}\NormalTok{(fit2B)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Linear mixed model fit by REML. t-tests use Satterthwaite's method [
lmerModLmerTest]
Formula: 
outcome ~ t * (warmth + physical_punishment + identity + intervention +  
    HDI) + (1 | country/id)
   Data: dfL

REML criterion at convergence: 57042.8

Scaled residuals: 
    Min      1Q  Median      3Q     Max 
-3.7118 -0.6092 -0.0024  0.6150  3.6779 

Random effects:
 Groups     Name        Variance Std.Dev.
 id:country (Intercept)  8.436   2.905   
 country    (Intercept)  3.675   1.917   
 Residual               26.046   5.104   
Number of obs: 9000, groups:  id:country, 3000; country, 30

Fixed effects:
                          Estimate   Std. Error           df t value
(Intercept)             51.0036725    1.6087742   49.9583024  31.703
t                        0.6989769    0.3746882 6131.2125222   1.865
warmth                   0.8170912    0.0805355 8274.9994610  10.146
physical_punishment     -1.0097729    0.1113557 8084.6085126  -9.068
identity                -0.2446453    0.3041604 8695.8966126  -0.804
intervention             0.6604671    0.3046286 8697.0843469   2.168
HDI                      0.0026692    0.0221295   36.1037721   0.121
t:warmth                 0.0486211    0.0356217 6404.8722416   1.365
t:physical_punishment    0.0004964    0.0494590 6753.0158846   0.010
t:identity               0.0563140    0.1318043 5993.4518199   0.427
t:intervention           0.0995037    0.1319917 5994.1433047   0.754
t:HDI                   -0.0009379    0.0038233 5993.9091197  -0.245
                                 Pr(>|t|)    
(Intercept)           <0.0000000000000002 ***
t                                  0.0622 .  
warmth                <0.0000000000000002 ***
physical_punishment   <0.0000000000000002 ***
identity                           0.4212    
intervention                       0.0302 *  
HDI                                0.9047    
t:warmth                           0.1723    
t:physical_punishment              0.9920    
t:identity                         0.6692    
t:intervention                     0.4510    
t:HDI                              0.8062    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Correlation of Fixed Effects:
            (Intr) t      warmth physc_ idntty intrvn HDI    t:wrmt t:phy_
t           -0.466                                                        
warmth      -0.169  0.285                                                 
physcl_pnsh -0.183  0.313 -0.005                                          
identity    -0.278  0.450 -0.013 -0.002                                   
interventin -0.100  0.162  0.039  0.019 -0.017                            
HDI         -0.892  0.230 -0.007  0.012 -0.001  0.003                     
t:warmth     0.150 -0.324 -0.882  0.001  0.011 -0.035  0.006              
t:physcl_pn  0.164 -0.351  0.004 -0.894 -0.001 -0.017 -0.010 -0.003       
t:identity   0.242 -0.519  0.011  0.000 -0.867  0.014  0.001 -0.013  0.002
t:intervntn  0.087 -0.187 -0.035 -0.017  0.014 -0.867 -0.003  0.041  0.019
t:HDI        0.310 -0.666  0.015 -0.027  0.002 -0.007 -0.346 -0.016  0.029
            t:dntt t:ntrv
t                        
warmth                   
physcl_pnsh              
identity                 
interventin              
HDI                      
t:warmth                 
t:physcl_pn              
t:identity               
t:intervntn -0.016       
t:HDI       -0.002  0.008
\end{verbatim}

\subsection{Julia}

\subsubsection{Get The Data}\label{get-the-data-5}

\begin{Shaded}
\begin{Highlighting}[]
\ImportTok{using} \BuiltInTok{Tables}\NormalTok{, }\BuiltInTok{MixedModels}\NormalTok{, }\BuiltInTok{StatFiles}\NormalTok{, }\BuiltInTok{DataFrames}\NormalTok{, }\BuiltInTok{CategoricalArrays}\NormalTok{, }\BuiltInTok{DataFramesMeta}

\NormalTok{dfL }\OperatorTok{=} \FunctionTok{DataFrame}\NormalTok{(}\FunctionTok{load}\NormalTok{(}\StringTok{"simulated\_multilevel\_longitudinal\_data.dta"}\NormalTok{))}
\end{Highlighting}
\end{Shaded}

\subsubsection{Run The Model}\label{run-the-model-5}

\paragraph{Change Country To
Categorical}\label{change-country-to-categorical-1}

\begin{Shaded}
\begin{Highlighting}[]
\PreprocessorTok{@transform}\NormalTok{!(dfL, }\OperatorTok{:}\NormalTok{country }\OperatorTok{=} \FunctionTok{categorical}\NormalTok{(}\OperatorTok{:}\NormalTok{country))}
\end{Highlighting}
\end{Shaded}

\paragraph{Main Effects Only}\label{main-effects-only-2}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m2A }\OperatorTok{=} \FunctionTok{fit}\NormalTok{(MixedModel, }\PreprocessorTok{@formula}\NormalTok{(outcome }\OperatorTok{\textasciitilde{}}\NormalTok{ t }\OperatorTok{+}\NormalTok{ warmth }\OperatorTok{+} 
\NormalTok{                                 physical\_punishment }\OperatorTok{+} 
\NormalTok{                                 identity }\OperatorTok{+}\NormalTok{ intervention }\OperatorTok{+} 
\NormalTok{                                 HDI }\OperatorTok{+}
\NormalTok{                                 (}\FloatTok{1} \OperatorTok{|}\NormalTok{ country) }\OperatorTok{+} 
\NormalTok{                                 (}\FloatTok{0} \OperatorTok{+}\NormalTok{ warmth }\OperatorTok{|}\NormalTok{ country) }\OperatorTok{+}
\NormalTok{                                 (}\FloatTok{1} \OperatorTok{|}\NormalTok{ id)), dfL)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Linear mixed model fit by maximum likelihood
 outcome ~ 1 + t + warmth + physical_punishment + identity + intervention + HDI + (1 | country) + (0 + warmth | country) + (1 | id)
    logLik   -2 logLik      AIC         AICc        BIC     
 -28499.6031  56999.2063  57021.2063  57021.2356  57099.3610

Variance components:
            Column    Variance Std.Dev.   Corr.
id       (Intercept)   8.387351 2.896092
country  (Intercept)   3.166939 1.779590
         warmth        0.010760 0.103732   .  
Residual              26.027290 5.101695
 Number of obs: 9000; levels of grouping factors: 3000, 30

  Fixed-effects parameters:
───────────────────────────────────────────────────────────────
                            Coef.  Std. Error       z  Pr(>|z|)
───────────────────────────────────────────────────────────────
(Intercept)          50.5949        1.35491     37.34    <1e-99
t                     0.943864      0.0658716   14.33    <1e-45
warmth                0.913496      0.0423739   21.56    <1e-99
physical_punishment  -1.0079        0.0497622  -20.25    <1e-90
identity             -0.127692      0.151584    -0.84    0.3996
intervention          0.858997      0.15191      5.65    <1e-07
HDI                  -0.000565882   0.0196433   -0.03    0.9770
───────────────────────────────────────────────────────────────
\end{verbatim}

\paragraph{Interactions With Time}\label{interactions-with-time-2}

\begin{Shaded}
\begin{Highlighting}[]
\NormalTok{m2B }\OperatorTok{=} \FunctionTok{fit}\NormalTok{(MixedModel, }\PreprocessorTok{@formula}\NormalTok{(outcome }\OperatorTok{\textasciitilde{}}\NormalTok{ t }\OperatorTok{*}\NormalTok{ (warmth }\OperatorTok{+} 
\NormalTok{                                 physical\_punishment }\OperatorTok{+} 
\NormalTok{                                 identity }\OperatorTok{+}\NormalTok{ intervention }\OperatorTok{+} 
\NormalTok{                                   HDI) }\OperatorTok{+}
\NormalTok{                                 (}\FloatTok{1} \OperatorTok{|}\NormalTok{ country) }\OperatorTok{+}
\NormalTok{                                 (}\FloatTok{0} \OperatorTok{+}\NormalTok{ warmth }\OperatorTok{|}\NormalTok{ country) }\OperatorTok{+}
\NormalTok{                                 (}\FloatTok{1} \OperatorTok{|}\NormalTok{ id)), dfL)}
\end{Highlighting}
\end{Shaded}

\begin{verbatim}
Linear mixed model fit by maximum likelihood
 outcome ~ 1 + t + warmth + physical_punishment + identity + intervention + HDI + t & warmth + t & physical_punishment + t & identity + t & intervention + t & HDI + (1 | country) + (0 + warmth | country) + (1 | id)
    logLik   -2 logLik      AIC         AICc        BIC     
 -28498.3091  56996.6182  57028.6182  57028.6788  57142.2979

Variance components:
            Column    Variance Std.Dev.   Corr.
id       (Intercept)   8.391746 2.896851
country  (Intercept)   3.170031 1.780458
         warmth        0.010609 0.102999   .  
Residual              26.015906 5.100579
 Number of obs: 9000; levels of grouping factors: 3000, 30

  Fixed-effects parameters:
──────────────────────────────────────────────────────────────────
                                Coef.  Std. Error      z  Pr(>|z|)
──────────────────────────────────────────────────────────────────
(Intercept)              51.0751       1.54284     33.10    <1e-99
t                         0.702771     0.374539     1.88    0.0606
warmth                    0.817076     0.0826636    9.88    <1e-22
physical_punishment      -1.00903      0.111293    -9.07    <1e-18
identity                 -0.238714     0.303996    -0.79    0.4323
intervention              0.660761     0.30445      2.17    0.0300
HDI                       0.00136065   0.0210842    0.06    0.9485
t & warmth                0.0483635    0.0356074    1.36    0.1744
t & physical_punishment   0.000542203  0.0494355    0.01    0.9912
t & identity              0.0554385    0.131745     0.42    0.6739
t & intervention          0.0992809    0.131925     0.75    0.4517
t & HDI                  -0.000955067  0.00382162  -0.25    0.8027
──────────────────────────────────────────────────────────────────
\end{verbatim}

\section{Interpretation}\label{interpretation-3}

The \emph{main effects only model} suggests that time is associated with
increases in the outcome. In the main effects model, main effects other
than time, indicate whether a particular variable is associated with
higher or lower intercepts of the time trajectory, at the beginning of
the study time. Warmth is again associated with increases in the
outcome, while physical punishment is associated with decreases in the
outcome. Identity is again not associated with the outcome, while the
intervention is associated with higher levels of the outcome. The Human
Development Index is again not associated with the outcome.

The second model adds interactions with time to the first model. Results
are largly similar to the prior model. However, here we not only examine
whether main effects other than time are associated with higher or lower
time trajectories, but also whether particular variables are associated
with differences in the slope of the time trajectory. In this case, we
find that no independent variable is associated with changes in the
slope of the time trajectory.

However, it may be illustrative to imagine how we would interpret the
results had a particular interaction term been statistically
significant. Let us consider one of the interaction terms with the
largest coefficient, \texttt{intervention\#time}. The interaction of the
intervention with time is positive. Had this coefficient been
statistically signifcant, it would have indicated that the intervention
was associated with more rapid increases in the outcome over time
\emph{in addition to} the fact that the intervention is associated with
higher initial levels of the outcome.

\bookmarksetup{startatroot}

\chapter*{References}\label{references}
\addcontentsline{toc}{chapter}{References}

\markboth{References}{References}

\phantomsection\label{refs}
\begin{CSLReferences}{1}{0}
\bibitem[\citeproctext]{ref-MixedModels}
Bates, D. (2024). \emph{{MixedModels.jl Documentation}}.
\url{https://juliastats.org/MixedModels.jl/stable/}

\bibitem[\citeproctext]{ref-JSSv067i01}
Bates, D., Mächler, M., Bolker, B., \& Walker, S. (2015). Fitting linear
mixed-effects models using lme4. \emph{Journal of Statistical Software},
\emph{67}(1), 1--48. \url{https://doi.org/10.18637/jss.v067.i01}

\bibitem[\citeproctext]{ref-JuliaArticle}
Bezanson, J., Edelman, A., Karpinski, S., \& Shah, V. B. (2017). Julia:
A fresh approach to numerical computing. \emph{SIAM Review},
\emph{59}(1), 65--98. \url{https://doi.org/10.1137/141000671}

\bibitem[\citeproctext]{ref-RProgram}
R Core Team. (2023). \emph{R: A language and environment for statistical
computing}. R Foundation for Statistical Computing.
\url{https://www.R-project.org/}

\bibitem[\citeproctext]{ref-Schanen2021}
Schanen, J. (2021). \emph{Math person ({Strogatz Prize} entry)}.
National Museum of Mathematics.

\bibitem[\citeproctext]{ref-StataCorp2021:2}
StataCorp. (2021). \emph{Stata 17 multilevel mixed effects reference
manual}. Stata Press.

\bibitem[\citeproctext]{ref-Thoreau1975}
Thoreau, H. D. (1975). The commercial spirit of modern times {[}1837{]}.
In J. J. Moldenhauer, E. Moser, \& A. C. Kern (Eds.), \emph{Early essays
and miscellanies}. Princeton University Press.

\end{CSLReferences}



\end{document}
