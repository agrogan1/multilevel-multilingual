[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Multilevel Multilingual",
    "section": "",
    "text": "1 Multilevel Multilingual",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Multilevel Multilingual</span>"
    ]
  },
  {
    "objectID": "index.html#introduction",
    "href": "index.html#introduction",
    "title": "Multilevel Multilingual",
    "section": "1.1 Introduction",
    "text": "1.1 Introduction\nBelow, I describe the use of Stata (StataCorp, 2023), R (Bates et al., 2015; R Core Team, 2023), and Julia (Bates, 2024; Bezanson et al., 2017) to estimate multilevel models.\nAll of these software packages can estimate multilevel models and can visualize relationships in the data. However, there are substantial differences between the different packages: Stata is proprietary for cost software, which is very well documented and very intuitive. While it costs money to purchase Stata, the price is often very reasonable for academic and educational use. R is free open source software which is less intuitive, but there are many excellent resources for learning R. There is often a cost associated with purchasing books and other materials for learning R, which sometimes feels like it offsets the fact that R is free. Julia is newer open source software, also free, and ostensibly much faster than either Stata or R, which may be an important advantage when running multilevel models with very large data sets. At this point in time, both Stata and R feel much more stable than Julia which is still evolving software.\nWhile any of these software packages can be used for learning and estimating multilevel models, I will offer my own opinion–based upon 15 years of teaching multilevel models at the doctoral level–that Stata offers the quickest pathway for learning the basic and advanced uses of multilevel models. I also believe the intuitive nature of Stata syntax contributes to accurate and replicable work in this area.\n\n\n\nTable 1.1: Software for Multilevel Modeling\n\n\n\n\n\n\n\n\n\n\nSoftware\nCost\nEase of Use\n\n\n\n\nStata\nsome cost\nlearning curve, but very intuitive for both multilevel modeling and graphing.\n\n\nR\nfree\nlearning curve: intuitive for multilevel modeling; but steeper learning curve for graphing (ggplot).\n\n\nJulia\nfree\nsteep learning curve in general: steep learning curve for multilevel modeling; and very steep learning curve for graphing. Graphics libraries are very much under development and in flux.\n\n\n\n\n\n\n\n\n\n\n\n\nResults Will Vary Somewhat\n\n\n\nEstimating multilevel models is a complex endeavor. The software details of how this is accomplished are beyond the purview of this book. Suffice it to say that across different software packages there will be differences in estimation routines, resulting in some numerical differences in the results provided by different software packages. Substantively speaking, however, results should agree across software.\n\n\n\n\n\n\n\n\nMulti-Line Commands\n\n\n\nSometimes I have written commands out over multiple lines. I have done this for especially long commands, but have also sometimes done this simply for the sake of clarity. The different software packages have different approaches to multi-line commands.\n\nBy default, Stata ends a command at the end of a line. If you are going to write a multi-line command you should use the /// line continuation characters.\nR is the software that most naturally can be written using multiple lines, as R commands are usually clearly encased in parentheses (()) or continued with + signs.\nLike Stata, Julia expects commands to end at the end of a line. If you are going to write a mult-line command, all commands except for the last line should end in a character that clearly indicates continuation, like a + sign. An alternative is to encase the entire Julia command in an outer set of parentheses (()).\n\n\n\n\n\n\n\n\n\nRunning Statistical Packages in Quarto\n\n\n\nI used Quarto (Allaire et al., 2024) (https://quarto.org/) to create this Appendix. Quarto is a programming and publishing environment that can run multiple programming languages, including Stata, R and Julia, and that can write to multiple output formats including HTML, PDF, and MS Word. To run Stata, I used the Statamarkdown library (Hemken, 2023) in R to connect Stata to Quarto. Quarto has a built in connection to R, and runs R without issue. To run Julia, I used the JuliaCall library (Li, 2019) in R to connect Quarto to Julia.\nOf course, each of these programs can be run by itself, if you have them installed on your computer.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Multilevel Multilingual</span>"
    ]
  },
  {
    "objectID": "index.html#sec-data",
    "href": "index.html#sec-data",
    "title": "Multilevel Multilingual",
    "section": "1.2 The Data",
    "text": "1.2 The Data\n\n\n\n\n\n\nDatasets\n\n\n\nThe examples use the simulated_multilevel_data.dta and simulated_multilevel_longitudinal_data.dta files.\nHere is a direct link to download the cross-sectional data.\nHere is a direct link to download the longitudinal data.\n\n\n\n\n\n\nTable 1.2: Sample of Simulated Multilevel Data\n\n\n\n\nTable continues below\n\n\n\n\n\n\n\n\n\n\n\ncountry\nHDI\nfamily\nid\nidentity\nintervention\nphysical_punishment\n\n\n\n\n1\n69\n1\n1.1\n1\n0\n3\n\n\n1\n69\n2\n1.2\n1\n1\n2\n\n\n1\n69\n3\n1.3\n0\n1\n3\n\n\n1\n69\n4\n1.4\n1\n0\n0\n\n\n1\n69\n5\n1.5\n1\n0\n4\n\n\n1\n69\n6\n1.6\n0\n1\n5\n\n\n\n\n\n\n\n\n\n\nwarmth\noutcome\n\n\n\n\n3\n57.47\n\n\n1\n50.1\n\n\n2\n52.92\n\n\n5\n60.17\n\n\n4\n55.05\n\n\n3\n49.81",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Multilevel Multilingual</span>"
    ]
  },
  {
    "objectID": "index.html#sec-syntax",
    "href": "index.html#sec-syntax",
    "title": "Multilevel Multilingual",
    "section": "1.3 An Introduction To Equations and Syntax",
    "text": "1.3 An Introduction To Equations and Syntax\nTo explain statistical syntax for each software, I consider the general case of a multilevel model with dependent variable y, independent variables x and z, clustering variable group, and a random slope for x. i is the index for the person, while j is the index for the group.\n\\[y = \\beta_0 + \\beta_1 x_{ij} + \\beta_2 z_{ij} + u_{0j} + u_{1j} \\times x_{ij} + e_{ij} \\tag{1.1}\\]\n\nStataRJulia\n\n\nIn Stata mixed, the syntax for a multilevel model of the form described in Equation 1.1 is:\n\nmixed y x z || group: x\n\n\n\nIn R lme4, the syntax for a multilevel model of the form described in Equation 1.1 is:\n\nlibrary(lme4)\n\nlmer(y ~ x + z + (1 + x || group), data = ...)\n\n\n\nIn Julia MixedModels, the syntax for a multilevel model of the form described in Equation 1.1 is:\n\nusing MixedModels\n\nfit(MixedModel, @formula(y ~ x + z + (1 + x | group)), data)\n\n\n\n\n\n\n\n\nAllaire, J. J., Teague, C., Scheidegger, C., Xie, Y., & Dervieux, C. (2024). Quarto (Version 1.4). https://doi.org/10.5281/zenodo.5960048\n\n\nBates, D. (2024). MixedModels.jl Documentation. https://juliastats.org/MixedModels.jl/stable/\n\n\nBates, D., Mächler, M., Bolker, B., & Walker, S. (2015). Fitting linear mixed-effects models using lme4. Journal of Statistical Software, 67(1), 1–48. https://doi.org/10.18637/jss.v067.i01\n\n\nBezanson, J., Edelman, A., Karpinski, S., & Shah, V. B. (2017). Julia: A fresh approach to numerical computing. SIAM Review, 59(1), 65–98. https://doi.org/10.1137/141000671\n\n\nHemken, D. (2023). Statamarkdown: ’Stata’ markdown. https://CRAN.R-project.org/package=Statamarkdown\n\n\nLi, C. (2019). JuliaCall: An R package for seamless integration between R and Julia. The Journal of Open Source Software, 4(35), 1284. https://doi.org/10.21105/joss.01284\n\n\nR Core Team. (2023). R: A language and environment for statistical computing. R Foundation for Statistical Computing. https://www.R-project.org/\n\n\nSchanen, J. (2021). Math person (Strogatz Prize entry). National Museum of Mathematics.\n\n\nStataCorp. (2023). Stata 18 mixed effects reference manual. Stata Press.\n\n\nThoreau, H. D. (1975). The commercial spirit of modern times [1837]. In J. J. Moldenhauer, E. Moser, & A. C. Kern (Eds.), Early essays and miscellanies. Princeton University Press.",
    "crumbs": [
      "<span class='chapter-number'>1</span>  <span class='chapter-title'>Multilevel Multilingual</span>"
    ]
  },
  {
    "objectID": "workflows-multilingual.html",
    "href": "workflows-multilingual.html",
    "title": "2  Statistical Workflows",
    "section": "",
    "text": "2.1 Statistical Software Is Best Run Using a Script\nMany statistical workflows–whatever the statistical package being used–follow the same conceptual pattern.\nIncreasingly, we want to think about workflows that are",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Statistical Workflows</span>"
    ]
  },
  {
    "objectID": "workflows-multilingual.html#statistical-software-is-best-run-using-a-script",
    "href": "workflows-multilingual.html#statistical-software-is-best-run-using-a-script",
    "title": "2  Statistical Workflows",
    "section": "",
    "text": "A Common Statistical Workflow\n\n\n\n\ndocumentable, transparent, and auditable: We have a record of what we did if we want to double check our work, clarify a result, or develop a new project with a similar process. We, or others, can find the inevitable errors in our work, and correct them.\nreplicable: Others can replicate our findings with the same or new data.\nscalable: We are developing a process that can be as easily used with thousands or millions of rows of data as it can with ten rows of data. We are developing a process that can be easily repeated if we are constantly getting new or updated data, e.g. getting new data every week, or every month.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Statistical Workflows</span>"
    ]
  },
  {
    "objectID": "workflows-multilingual.html#scripts",
    "href": "workflows-multilingual.html#scripts",
    "title": "2  Statistical Workflows",
    "section": "2.2 Scripts",
    "text": "2.2 Scripts\nFor most statistical workflows, we will often want to write a script or code. Data analysis scripts can be stored in a Quarto document (Allaire et al., 2024) as they are in this Appendix, or every statistical package has its own unique format for storing scripts as a text file: in Stata, scripts are stored in .do files; in R, scripts are stored in .R files, and in Julia, scripts are stored in .jl files.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Statistical Workflows</span>"
    ]
  },
  {
    "objectID": "workflows-multilingual.html#sec-script-flow",
    "href": "workflows-multilingual.html#sec-script-flow",
    "title": "2  Statistical Workflows",
    "section": "2.3 Script Flow",
    "text": "2.3 Script Flow\nA good practice when writing a script, is to have a script that begins with the raw data, moves through any necessary re-coding or cleaning of the data, generates descriptive statistics, generates the appropriate multivariate results, and then generates any necessary visualizations.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Statistical Workflows</span>"
    ]
  },
  {
    "objectID": "workflows-multilingual.html#storing-statistical-data",
    "href": "workflows-multilingual.html#storing-statistical-data",
    "title": "2  Statistical Workflows",
    "section": "2.4 Storing Statistical Data",
    "text": "2.4 Storing Statistical Data\nIt is usually best to store quantitative data in a statistical format such as R (.Rdata), or Stata (.dta), or even a text format such as .csv. Spreadsheets are likely to be a bad tool for storing quantitative data.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Statistical Workflows</span>"
    ]
  },
  {
    "objectID": "workflows-multilingual.html#sec-multiple-packages",
    "href": "workflows-multilingual.html#sec-multiple-packages",
    "title": "2  Statistical Workflows",
    "section": "2.5 It Is Possible To Use Multiple Statistical Packages",
    "text": "2.5 It Is Possible To Use Multiple Statistical Packages\nWhile this Appendix focuses on the use of each individual statistical package on its own, it is certainly possible to use multiple statistical packages as part of the same workflow. For example, one might employ Stata to carry out data management tasks, and then possibly use R to run a multilevel model with a more complicated multilevel structure, such as a cross-classified model, or Julia to more quickly run a model with a large data.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Statistical Workflows</span>"
    ]
  },
  {
    "objectID": "workflows-multilingual.html#good-statistical-workflows-require-safe-workspaces",
    "href": "workflows-multilingual.html#good-statistical-workflows-require-safe-workspaces",
    "title": "2  Statistical Workflows",
    "section": "2.6 Good Statistical Workflows Require Safe Workspaces",
    "text": "2.6 Good Statistical Workflows Require Safe Workspaces\nIt is also very important to be aware that good complex workflows are highly iterative and highly collaborative. Good complex workflows require a safe workspace in which team members feel free to admit their own errors, and help with others’ mistakes in a non-judgmental fashion. Such a safe environment is necessary to build an environment where the overall error rate is low.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Statistical Workflows</span>"
    ]
  },
  {
    "objectID": "workflows-multilingual.html#good-statistical-workflows-require-patience-and-can-be-psychologically-demanding",
    "href": "workflows-multilingual.html#good-statistical-workflows-require-patience-and-can-be-psychologically-demanding",
    "title": "2  Statistical Workflows",
    "section": "2.7 Good Statistical Workflows Require Patience And Can Be Psychologically Demanding",
    "text": "2.7 Good Statistical Workflows Require Patience And Can Be Psychologically Demanding\nDeveloping a good documented and auditable workflow that is implemented in code requires a lot of patience, and often, many iterations. Working through these many iterations can be psychologically demanding. It is important to remember that careful attention to getting the details right early in the research process, while sometimes tiring and frustrating, will pay large dividends later on when the research is reviewed, presented, published and read.",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Statistical Workflows</span>"
    ]
  },
  {
    "objectID": "workflows-multilingual.html#good-statistical-workflows-often-allow-multiple-principled-ways-forward",
    "href": "workflows-multilingual.html#good-statistical-workflows-often-allow-multiple-principled-ways-forward",
    "title": "2  Statistical Workflows",
    "section": "2.8 Good Statistical Workflows Often Allow Multiple Principled Ways Forward",
    "text": "2.8 Good Statistical Workflows Often Allow Multiple Principled Ways Forward\nOne of my most recent ideas about statistical workflows is that there are certainly wrong decisions that one can make with data.\nFor example, I would not want to write the paper that says that smoking prevents lung cancer, nor would I want to write a paper saying physical punishment is good for children.\nThat being said, I think there are often multiple principled ways forward.\nOften the key is not so much to make the 100% correct decision, but to make one of several possible principled decisions.\nThen after making a principled decision, one is transparent and thorough about describing the decision that one made.\nFor example, in implementing a multilevel analysis, I would have many choices: I could estimate only a random intercept; estimate one or more random slopes; or estimate all possible random slopes. The random effects could be correlated or uncorrelated. I could estimate only main effects, or could estimate interactions of several variables. Each of these would be a different, yet principled, approach to analyzing the data.\nIn science and statistics, we often want an answer that provides one clear direction. Instead, I’m increasingly convinced that the best science (and teaching!) often involves engaging in open discussion about the multiple possible alternatives, and then choosing one principled solution, and being transparent about its implementation.\n\n\n\nA Common Statistical Workflow\n\n\n\nAllaire, J. J., Teague, C., Scheidegger, C., Xie, Y., & Dervieux, C. (2024). Quarto (Version 1.4). https://doi.org/10.5281/zenodo.5960048",
    "crumbs": [
      "<span class='chapter-number'>2</span>  <span class='chapter-title'>Statistical Workflows</span>"
    ]
  },
  {
    "objectID": "descriptives-multilingual.html",
    "href": "descriptives-multilingual.html",
    "title": "3  Descriptive Statistics",
    "section": "",
    "text": "3.1 Descriptive Statistics",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Descriptive Statistics</span>"
    ]
  },
  {
    "objectID": "descriptives-multilingual.html#descriptive-statistics",
    "href": "descriptives-multilingual.html#descriptive-statistics",
    "title": "3  Descriptive Statistics",
    "section": "",
    "text": "StataRJulia\n\n\n\n\nuse simulated_multilevel_data.dta // use data\n\nWe use summarize for continuous variables, and tabulate for categorical variables.\n\nsummarize outcome warmth physical_punishment HDI\n\ntabulate identity\n\ntabulate intervention\n\n    Variable |        Obs        Mean    Std. dev.       Min        Max\n-------------+---------------------------------------------------------\n     outcome |      3,000    52.43327    6.530996   29.60798   74.83553\n      warmth |      3,000    3.521667    1.888399          0          7\nphysical_p~t |      3,000    2.478667    1.360942          0          5\n         HDI |      3,000    64.76667    17.24562         33         87\n\n\nhypothetica |\n l identity |\n      group |\n   variable |      Freq.     Percent        Cum.\n------------+-----------------------------------\n          0 |      1,507       50.23       50.23\n          1 |      1,493       49.77      100.00\n------------+-----------------------------------\n      Total |      3,000      100.00\n\n\n   recieved |\ninterventio |\n          n |      Freq.     Percent        Cum.\n------------+-----------------------------------\n          0 |      1,547       51.57       51.57\n          1 |      1,453       48.43      100.00\n------------+-----------------------------------\n      Total |      3,000      100.00\n\n\n\n\n\nlibrary(haven) # read data in Stata format\n\ndf &lt;- read_dta(\"simulated_multilevel_data.dta\")\n\nR’s descriptive statistics functions rely heavily on whether a variable is a numeric variable, or a factor variable. Below, I convert two variables to factors (factor) before using summary1 to generate descriptive statistics.\n\ndf$country &lt;- factor(df$country)\n\ndf$identity &lt;- factor(df$identity)\n\ndf$intervention &lt;- factor(df$intervention)\n\nsummary(df)\n\n    country          HDI            family            id            identity\n 1      : 100   Min.   :33.00   Min.   :  1.00   Length:3000        0:1507  \n 2      : 100   1st Qu.:53.00   1st Qu.: 25.75   Class :character   1:1493  \n 3      : 100   Median :70.00   Median : 50.50   Mode  :character           \n 4      : 100   Mean   :64.77   Mean   : 50.50                              \n 5      : 100   3rd Qu.:81.00   3rd Qu.: 75.25                              \n 6      : 100   Max.   :87.00   Max.   :100.00                              \n (Other):2400                                                               \n intervention physical_punishment     warmth         outcome     \n 0:1547       Min.   :0.000       Min.   :0.000   Min.   :29.61  \n 1:1453       1st Qu.:2.000       1st Qu.:2.000   1st Qu.:48.02  \n              Median :2.000       Median :4.000   Median :52.45  \n              Mean   :2.479       Mean   :3.522   Mean   :52.43  \n              3rd Qu.:3.000       3rd Qu.:5.000   3rd Qu.:56.86  \n              Max.   :5.000       Max.   :7.000   Max.   :74.84  \n                                                                 \n\n\n\n\n\nusing Tables, MixedModels, MixedModelsExtras, StatFiles, DataFrames, CategoricalArrays, DataFramesMeta\n\ndf = DataFrame(load(\"simulated_multilevel_data.dta\"))\n\nSimilarly to R, Julia relies on the idea of variable type. I use transform to convert the appropriate variables to categorical variables.\n\n@transform!(df, :country = categorical(:country))\n\n@transform!(df, :identity = categorical(:identity))\n\n@transform!(df, :intervention = categorical(:intervention))\n\n\n\ndescribe(df) # descriptive statistics\n\n9×7 DataFrame\n Row │ variable             mean     min     median  max      nmissing  eltype ⋯\n     │ Symbol               Union…   Any     Union…  Any      Int64     Union  ⋯\n─────┼──────────────────────────────────────────────────────────────────────────\n   1 │ country                       1.0             30.0            0  Union{ ⋯\n   2 │ HDI                  64.7667  33.0    70.0    87.0            0  Union{\n   3 │ family               50.5     1.0     50.5    100.0           0  Union{\n   4 │ id                            1.1             9.99            0  Union{\n   5 │ identity                      0.0             1.0             0  Union{ ⋯\n   6 │ intervention                  0.0             1.0             0  Union{\n   7 │ physical_punishment  2.47867  0.0     2.0     5.0             0  Union{\n   8 │ warmth               3.52167  0.0     4.0     7.0             0  Union{\n   9 │ outcome              52.4333  29.608  52.449  74.8355         0  Union{ ⋯\n                                                                1 column omitted",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Descriptive Statistics</span>"
    ]
  },
  {
    "objectID": "descriptives-multilingual.html#interpretation",
    "href": "descriptives-multilingual.html#interpretation",
    "title": "3  Descriptive Statistics",
    "section": "3.2 Interpretation",
    "text": "3.2 Interpretation\nExamining descriptive statistics is an important first step in any analysis. It is important to examine your descriptive statistics before skipping ahead to more sophisticated analyses, such as multilevel models.\nIn examining the descriptive statistics for this data, we get a sense of the data.\n\noutcome has a mean of approximately 52 and ranges from approximately 30 to 75.\nwarmth and physical punishment are both variables that represent the number of times that parents use each of these forms of discipline in a week. The average of the former is about 3.5, while the average of the latter is about 2.5.\nHDI, the Human Development Index has an average of about 65, and a wide range.\nidentity is a categorical variable for a hypothetical identity group, and has values of 0 and 1.\nintervention is also a categorical variable, and has values of 0 and 1.",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Descriptive Statistics</span>"
    ]
  },
  {
    "objectID": "descriptives-multilingual.html#footnotes",
    "href": "descriptives-multilingual.html#footnotes",
    "title": "3  Descriptive Statistics",
    "section": "",
    "text": "skimr is an excellent new alternative library for generating descriptive statistics in R.↩︎",
    "crumbs": [
      "<span class='chapter-number'>3</span>  <span class='chapter-title'>Descriptive Statistics</span>"
    ]
  },
  {
    "objectID": "unconditional-multilingual.html",
    "href": "unconditional-multilingual.html",
    "title": "4  Unconditional Models",
    "section": "",
    "text": "4.1 Two Level Model\nAn unconditional multilevel model is a model with no independent variables. One should always run an unconditional model as the first step of a multilevel model in order to get a sense of the way that variation is apportioned in the model across the different levels.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Unconditional Models</span>"
    ]
  },
  {
    "objectID": "unconditional-multilingual.html#two-level-model",
    "href": "unconditional-multilingual.html#two-level-model",
    "title": "4  Unconditional Models",
    "section": "",
    "text": "4.1.1 The Equation\n\\[\\text{outcome}_{ij}= \\beta_0 + u_{0j} + e_{ij} \\tag{4.1}\\]\nThe Intraclass Correlation Coefficient (ICC) is given by:\n\\[\\text{ICC} = \\frac{var(u_{0j})}{var(u_{0j}) + var(e_{ij})} \\tag{4.2}\\]\nIn a two level multilevel model, the ICC provides a measure of the proportion of variation attributable to Level 2.\n\n\n4.1.2 Run Models\n\nStataRJulia\n\n\n\n\nuse simulated_multilevel_data.dta // use data\n\nmixed outcome || country:  // unconditional model\n\nestat icc // ICC\n\nPerforming EM optimization ...\n\nPerforming gradient-based optimization: \nIteration 0:  Log likelihood = -9802.8371  \nIteration 1:  Log likelihood = -9802.8371  \n\nComputing standard errors ...\n\nMixed-effects ML regression                           Number of obs    = 3,000\nGroup variable: country                               Number of groups =    30\n                                                      Obs per group:\n                                                                   min =   100\n                                                                   avg = 100.0\n                                                                   max =   100\n                                                      Wald chi2(0)     =     .\nLog likelihood = -9802.8371                           Prob &gt; chi2      =     .\n\n------------------------------------------------------------------------------\n     outcome | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n       _cons |   52.43327   .3451217   151.93   0.000     51.75685     53.1097\n------------------------------------------------------------------------------\n\n------------------------------------------------------------------------------\n  Random-effects parameters  |   Estimate   Std. err.     [95% conf. interval]\n-----------------------------+------------------------------------------------\ncountry: Identity            |\n                  var(_cons) |   3.178658   .9226737      1.799552    5.614658\n-----------------------------+------------------------------------------------\n               var(Residual) |   39.46106   1.024013      37.50421       41.52\n------------------------------------------------------------------------------\nLR test vs. linear model: chibar2(01) = 166.31        Prob &gt;= chibar2 = 0.0000\n\n\nIntraclass correlation\n\n------------------------------------------------------------------------------\n                       Level |        ICC   Std. err.     [95% conf. interval]\n-----------------------------+------------------------------------------------\n                     country |   .0745469   .0201254      .0434963    .1248696\n------------------------------------------------------------------------------\n\n\n\n\n\nlibrary(haven)\n\ndf &lt;- read_dta(\"simulated_multilevel_data.dta\")\n\n\nlibrary(lme4) # estimate multilevel models\n\nfit0 &lt;- lmer(outcome ~ (1 | country),\n             data = df) # unconditional model\n\nsummary(fit0)\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: outcome ~ (1 | country)\n   Data: df\n\nREML criterion at convergence: 19605.9\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.3844 -0.6655 -0.0086  0.6725  3.6626 \n\nRandom effects:\n Groups   Name        Variance Std.Dev.\n country  (Intercept)  3.302   1.817   \n Residual             39.461   6.282   \nNumber of obs: 3000, groups:  country, 30\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)   52.433      0.351   149.4\n\n\n\nlibrary(performance)\n\nperformance::icc(fit0) # ICC\n\n# Intraclass Correlation Coefficient\n\n    Adjusted ICC: 0.077\n  Unadjusted ICC: 0.077\n\n\n\n\n\nusing Tables, MixedModels, MixedModelsExtras, \nStatFiles, DataFrames, CategoricalArrays, DataFramesMeta\n\ndf = DataFrame(load(\"simulated_multilevel_data.dta\"))\n\n\n@transform!(df, :country = categorical(:country))\n\n\n\nm0 = fit(MixedModel, \n         @formula(outcome ~ (1 | country)), df) # unconditional model\n\nLinear mixed model fit by maximum likelihood\n outcome ~ 1 + (1 | country)\n   logLik   -2 logLik     AIC       AICc        BIC    \n -9802.8371 19605.6742 19611.6742 19611.6822 19629.6933\n\nVariance components:\n            Column   Variance Std.Dev.\ncountry  (Intercept)   3.17863 1.78287\nResidual              39.46106 6.28180\n Number of obs: 3000; levels of grouping factors: 30\n\n  Fixed-effects parameters:\n──────────────────────────────────────────────────\n               Coef.  Std. Error       z  Pr(&gt;|z|)\n──────────────────────────────────────────────────\n(Intercept)  52.4333    0.345121  151.93    &lt;1e-99\n──────────────────────────────────────────────────\n\n\n\n\nicc(m0) # ICC\n\n0.07454637475695493\n\n\n\n\n\n\n\n4.1.3 Interpretation\nIn each case, the software finds that nearly 8% of the variation in the outcome is explainable by the clustering of the observations in each country.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Unconditional Models</span>"
    ]
  },
  {
    "objectID": "unconditional-multilingual.html#three-level-model",
    "href": "unconditional-multilingual.html#three-level-model",
    "title": "4  Unconditional Models",
    "section": "4.2 Three Level Model",
    "text": "4.2 Three Level Model\n\n4.2.1 The Equation\n\\[\\text{outcome}_{ij}= \\beta_0 + u_{0j} + v_{0i} + e_{ij} \\tag{4.3}\\]\nAs discussed in the main text, in a three level model, there are two intraclass correlation coefficients (StataCorp, 2023). The formulas for the Intraclass Correlation Coefficient (ICC) are given by (StataCorp, 2023):\n\\[\\text{ICC} = \\frac{var(u_{0j})}{var(u_{0j}) + var(v_{0i}) + var(e_{ij})} \\tag{4.4}\\]\nFollowing StataCorp (2023), Equation 4.4 is the correlation of responses for person-timepoints from the same country but different persons.\n\\[\\text{ICC} = \\frac{var(u_{0j}) + var(v_{0i})}{var(u_{0j}) + var(v_{0i}) + var(e_{ij})} \\tag{4.5}\\]\nAgain, closely following StataCorp (2023), Equation 4.5 is the correlation of responses for person-timepoints from the same country and same person.\n\n\n4.2.2 Run Models\n\nStataRJulia\n\n\n\n\nuse simulated_multilevel_longitudinal_data.dta // use data\n\nmixed outcome || country: || id: // unconditional model\n  \nestat icc // ICC\n\nPerforming EM optimization ...\n\nPerforming gradient-based optimization: \nIteration 0:  Log likelihood = -29058.266  \nIteration 1:  Log likelihood = -29058.259  \nIteration 2:  Log likelihood = -29058.259  \n\nComputing standard errors ...\n\nMixed-effects ML regression                              Number of obs = 9,000\n\n        Grouping information\n        -------------------------------------------------------------\n                        |     No. of       Observations per group\n         Group variable |     groups    Minimum    Average    Maximum\n        ----------------+--------------------------------------------\n                country |         30        300      300.0        300\n                     id |      3,000          3        3.0          3\n        -------------------------------------------------------------\n\n                                                         Wald chi2(0)  =     .\nLog likelihood = -29058.259                              Prob &gt; chi2   =     .\n\n------------------------------------------------------------------------------\n     outcome | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]\n-------------+----------------------------------------------------------------\n       _cons |   53.37768   .3387943   157.55   0.000     52.71366    54.04171\n------------------------------------------------------------------------------\n\n------------------------------------------------------------------------------\n  Random-effects parameters  |   Estimate   Std. err.     [95% conf. interval]\n-----------------------------+------------------------------------------------\ncountry: Identity            |\n                  var(_cons) |   3.232092   .8891367      1.885043     5.54174\n-----------------------------+------------------------------------------------\nid: Identity                 |\n                  var(_cons) |   11.72403   .5747501      10.64996    12.90641\n-----------------------------+------------------------------------------------\n               var(Residual) |   28.23424   .5154843      27.24178    29.26287\n------------------------------------------------------------------------------\nLR test vs. linear model: chi2(2) = 1314.88               Prob &gt; chi2 = 0.0000\n\nNote: LR test is conservative and provided only for reference.\n\n\nIntraclass correlation\n\n------------------------------------------------------------------------------\n                       Level |        ICC   Std. err.     [95% conf. interval]\n-----------------------------+------------------------------------------------\n                     country |   .0748336   .0190847      .0450028    .1219141\n                  id|country |   .3462837   .0171461      .3134867    .3806097\n------------------------------------------------------------------------------\n\n\n\n\nIn R, the ICC for a three level model is easiest to estimate “by hand”.\n\nlibrary(haven)\n\ndfL &lt;- read_dta(\"simulated_multilevel_longitudinal_data.dta\")\n\n\nlibrary(lme4) # estimate multilevel models\n\nfit0L &lt;- lmer(outcome ~ (1 | country/id),\n             data = dfL) # unconditional model\n\nsummary(fit0L)\n\nLinear mixed model fit by REML ['lmerMod']\nFormula: outcome ~ (1 | country/id)\n   Data: dfL\n\nREML criterion at convergence: 58116.8\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.7858 -0.6059 -0.0062  0.6017  3.4348 \n\nRandom effects:\n Groups     Name        Variance Std.Dev.\n id:country (Intercept) 11.724   3.424   \n country    (Intercept)  3.351   1.830   \n Residual               28.234   5.314   \nNumber of obs: 9000, groups:  id:country, 3000; country, 30\n\nFixed effects:\n            Estimate Std. Error t value\n(Intercept)  53.3777     0.3446   154.9\n\n\n\n3.351 / (11.724 + 3.351 + 28.234)\n\n[1] 0.07737422\n\n(3.351 + 11.724) / (11.724 + 3.351 + 28.234)\n\n[1] 0.3480801\n\n\n\n\nIn Julia, the ICC for a three level model is also easiest to estimate “by hand”.\n\nusing Tables, MixedModels, StatFiles, DataFrames, CategoricalArrays, DataFramesMeta\n\ndfL = DataFrame(load(\"simulated_multilevel_longitudinal_data.dta\"))\n\n\n@transform!(dfL, :country = categorical(:country))\n\n\n\nm0L = fit(MixedModel, @formula(outcome ~ \n                                 (1 | country) + \n                                 (1 | id)), dfL)\n\nLinear mixed model fit by maximum likelihood\n outcome ~ 1 + (1 | country) + (1 | id)\n    logLik   -2 logLik      AIC         AICc        BIC     \n -29058.2592  58116.5184  58124.5184  58124.5229  58152.9384\n\nVariance components:\n            Column   Variance Std.Dev.\nid       (Intercept)  11.72401 3.42403\ncountry  (Intercept)   3.23190 1.79775\nResidual              28.23426 5.31359\n Number of obs: 9000; levels of grouping factors: 3000, 30\n\n  Fixed-effects parameters:\n──────────────────────────────────────────────────\n               Coef.  Std. Error       z  Pr(&gt;|z|)\n──────────────────────────────────────────────────\n(Intercept)  53.3777    0.338785  157.56    &lt;1e-99\n──────────────────────────────────────────────────\n\n\n\n\n3.23190 / (11.72401 + 3.23190 + 28.23426)\n\n0.07482952718176382\n\n\n(3.23190 + 11.72401) / (11.72401 + 3.23190 + 28.23426)\n\n0.34628041519632824\n\n\n\n\n\n\n\n4.2.3 Interpretation\nEach software suggests that almost 8% of the variation in the outcome is within time points for different individuals within the same country, while almost 35% of the variation in the outcome is within time points for the same individual within the same country.\n\n\n\n\nStataCorp. (2023). Stata 18 mixed effects reference manual. Stata Press.",
    "crumbs": [
      "<span class='chapter-number'>4</span>  <span class='chapter-title'>Unconditional Models</span>"
    ]
  },
  {
    "objectID": "cross-sectional-multilingual.html",
    "href": "cross-sectional-multilingual.html",
    "title": "5  Cross Sectional Multilevel Models",
    "section": "",
    "text": "5.1 The Equation\nRecall the general model of Equation 1.1, and the syntax outlined in Section 1.3. Below in Equation 5.1, we consider a more substantive example.\n\\[\\text{outcome}_{ij}= \\beta_0 + \\beta_1 \\text{warmth}_{ij} + \\tag{5.1}\\]\n\\[\\beta_2 \\text{physical punishment}_{ij} +\\]\n\\[\\beta_3 \\text{identity}_{ij} + \\beta_4 \\text{intervention}_{ij} + \\beta_5 \\text{HDI}_{j} +\\]\n\\[u_{0j} + u_{1j} \\times \\text{warmth}_{ij} + e_{ij}\\]",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Cross Sectional Multilevel Models</span>"
    ]
  },
  {
    "objectID": "cross-sectional-multilingual.html#correlated-and-uncorrelated-random-effects",
    "href": "cross-sectional-multilingual.html#correlated-and-uncorrelated-random-effects",
    "title": "5  Cross Sectional Multilevel Models",
    "section": "5.2 Correlated and Uncorrelated Random Effects",
    "text": "5.2 Correlated and Uncorrelated Random Effects\nConsider the covariance matrix of random effects (e.g. \\(u_{0j}\\) and \\(u_{1j}\\)). In Equation 5.2 the covariances of the random effects are constrained to be zero.\n\\[\\begin{bmatrix}\nvar(u_{0j}) & 0 \\\\\n0 & var(u_{1j})\n\\end{bmatrix} \\tag{5.2}\\]\nAs discussed in the Chapter on multilevel models with cross-sectional data, however, one can consider a multilevel model in which the random effects are correlated, as is the case in Equation 5.3.\n\\[\\begin{bmatrix}\nvar(u_{0j}) & cov(u_{0j}, u_{1j}) \\\\\ncov(u_{0j}, u_{1j}) & var(u_{1j})\n\\end{bmatrix} \\tag{5.3}\\]\nProcedures for estimating models with uncorrelated and correlated random effects are detailed below (Bates et al., 2015; Bates, 2024; StataCorp, 2023).\n\n\n\nTable 5.1: Correlated and Uncorrelated Random Effects\n\n\n\n\n\n\n\n\n\n\nSoftware\nUncorrelated Random Effects\nCorrelated Random Effects\n\n\n\n\nStata\ndefault\nadd option: , cov(uns)\n\n\nR\nseparate random effects from grouping variable with ||\nseparate random effects from grouping variable with |\n\n\nJulia\nseparate terms for each random effect e.g. (1 | group) + (0 + x | group)\nseparate random effects from grouping variable with |.\n\n\n\n\n\n\nAll models in the examples below are run with uncorrelated random effects, but could just as easily be run with correlated random effects.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Cross Sectional Multilevel Models</span>"
    ]
  },
  {
    "objectID": "cross-sectional-multilingual.html#run-models",
    "href": "cross-sectional-multilingual.html#run-models",
    "title": "5  Cross Sectional Multilevel Models",
    "section": "5.3 Run Models",
    "text": "5.3 Run Models\n\n\n\n\n\n\nContinuous and Categorical Variables\n\n\n\nStatistically–as noted in the main text–it is important to be clear on whether independent variables in one’s model are continuous or categorical. Continuous variables can be entered straightforwardly into statistical syntax. Categorical variables, on the other hand usually require specific attention in statistical software. In Stata, categorical variables are indicated in a statistical model by prefixing them with an i.. In R, categorical variables are distinguished by making them into factors e.g. x &lt;- factor(x). In Julia, categorical variables are created by using the @transform syntax detailed below.\n\n\n\nStataRJulia\n\n\n\n5.3.0.1 Get The Data\n\n\nuse simulated_multilevel_data.dta\n\n\n\n5.3.0.2 Run The Model\n\nmixed outcome warmth physical_punishment i.identity i.intervention HDI || /// \ncountry: warmth\n\nPerforming EM optimization ...\n\nPerforming gradient-based optimization: \nIteration 0:  Log likelihood = -9626.6279  \nIteration 1:  Log likelihood =  -9626.607  \nIteration 2:  Log likelihood =  -9626.607  \n\nComputing standard errors ...\n\nMixed-effects ML regression                          Number of obs    =  3,000\nGroup variable: country                              Number of groups =     30\n                                                     Obs per group:\n                                                                  min =    100\n                                                                  avg =  100.0\n                                                                  max =    100\n                                                     Wald chi2(5)     = 334.14\nLog likelihood =  -9626.607                          Prob &gt; chi2      = 0.0000\n\n-------------------------------------------------------------------------------------\n            outcome | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]\n--------------------+----------------------------------------------------------------\n             warmth |   .8345368   .0637213    13.10   0.000     .7096453    .9594282\nphysical_punishment |  -.9916657   .0797906   -12.43   0.000    -1.148052   -.8352791\n         1.identity |  -.3004767   .2170295    -1.38   0.166    -.7258466    .1248933\n     1.intervention |   .6396427   .2174519     2.94   0.003     .2134448    1.065841\n                HDI |   -.003228   .0199257    -0.16   0.871    -.0422817    .0358256\n              _cons |   51.99991   1.371257    37.92   0.000      49.3123    54.68753\n-------------------------------------------------------------------------------------\n\n------------------------------------------------------------------------------\n  Random-effects parameters  |   Estimate   Std. err.     [95% conf. interval]\n-----------------------------+------------------------------------------------\ncountry: Independent         |\n                 var(warmth) |   .0227504   .0257784      .0024689    .2096436\n                  var(_cons) |   2.963975   .9737647      1.556777    5.643163\n-----------------------------+------------------------------------------------\n               var(Residual) |   34.97499   .9097109      33.23668    36.80422\n------------------------------------------------------------------------------\nLR test vs. linear model: chi2(2) = 205.74                Prob &gt; chi2 = 0.0000\n\nNote: LR test is conservative and provided only for reference.\n\n\n\n\n\n\n5.3.0.3 Get The Data\n\nlibrary(haven)\n\ndf &lt;- read_dta(\"simulated_multilevel_data.dta\")\n\n\n\n5.3.0.4 Change Some Variables To Categorical\n\ndf$identity &lt;- factor(df$identity)\n\ndf$intervention &lt;- factor(df$intervention)\n\n\n\n5.3.0.5 Run The Model\n\n\n\n\n\n\nCaution\n\n\n\n\n\nlme4 does not directly provide p values in results, because of some disagreement over exactly how these p values should be calculated. Therefore, in this Appendix, I also call library lmerTest to provide p values for lme4 results.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nR prefers to use scientific notation when possible. I find that the use of scientific notation can be confusing in reading results. I turn off scientific notation by setting a penalty for its use: options(scipen = 999).\n\n\n\nlibrary(lme4) \n\nlibrary(lmerTest)\n\noptions(scipen = 999) \n\nfit1 &lt;- lmer(outcome ~ warmth + physical_punishment + \n               identity + intervention + HDI +\n               (1 + warmth || country),\n             data = df)\n\nsummary(fit1)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: outcome ~ warmth + physical_punishment + identity + intervention +  \n    HDI + (1 + warmth || country)\n   Data: df\n\nREML criterion at convergence: 19268.8\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.9774 -0.6563  0.0186  0.6645  3.6730 \n\nRandom effects:\n Groups    Name        Variance Std.Dev.\n country   (Intercept)  3.19120 1.786   \n country.1 warmth       0.02464 0.157   \n Residual              35.01779 5.918   \nNumber of obs: 3000, groups:  country, 30\n\nFixed effects:\n                       Estimate  Std. Error          df t value\n(Intercept)           52.011324    1.414976   30.293141  36.758\nwarmth                 0.834562    0.064250   41.896457  12.989\nphysical_punishment   -0.991893    0.079845 2968.012381 -12.423\nidentity1             -0.300354    0.217179 2970.108153  -1.383\nintervention1          0.639060    0.217603 2971.186718   2.937\nHDI                   -0.003394    0.020598   27.592814  -0.165\n                                Pr(&gt;|t|)    \n(Intercept)         &lt; 0.0000000000000002 ***\nwarmth              0.000000000000000277 ***\nphysical_punishment &lt; 0.0000000000000002 ***\nidentity1                        0.16678    \nintervention1                    0.00334 ** \nHDI                              0.87030    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) warmth physc_ idntt1 intrv1\nwarmth      -0.124                            \nphyscl_pnsh -0.149 -0.003                     \nidentity1   -0.072 -0.012 -0.003              \ninterventn1 -0.082  0.034  0.022 -0.018       \nHDI         -0.943 -0.006  0.009 -0.001  0.000\n\n\n\n\n\n\n5.3.0.6 Get The Data\n\nusing Tables, MixedModels, StatFiles, DataFrames, CategoricalArrays, DataFramesMeta\n\ndf = DataFrame(load(\"simulated_multilevel_data.dta\"))\n\n\n\n5.3.0.7 Change Some Variables To Categorical\n\n@transform!(df, :country = categorical(:country))\n\n@transform!(df, :identity = categorical(:identity))\n\n@transform!(df, :intervention = categorical(:intervention))\n\n\n\n5.3.0.8 Run The Model\n\n\nm1 = fit(MixedModel, @formula(outcome ~ warmth + physical_punishment + \n               identity + intervention + HDI +\n               (1 | country) +\n               (0 + warmth | country)), df)\n\nLinear mixed model fit by maximum likelihood\n outcome ~ 1 + warmth + physical_punishment + identity + intervention + HDI + (1 | country) + (0 + warmth | country)\n   logLik   -2 logLik     AIC       AICc        BIC    \n -9626.6070 19253.2140 19271.2140 19271.2742 19325.2713\n\nVariance components:\n            Column    Variance Std.Dev.   Corr.\ncountry  (Intercept)   2.963849 1.721583\n         warmth        0.022756 0.150852   .  \nResidual              34.974984 5.913965\n Number of obs: 3000; levels of grouping factors: 30\n\n  Fixed-effects parameters:\n─────────────────────────────────────────────────────────────\n                          Coef.  Std. Error       z  Pr(&gt;|z|)\n─────────────────────────────────────────────────────────────\n(Intercept)          51.9999      1.37124     37.92    &lt;1e-99\nwarmth                0.834537    0.0637228   13.10    &lt;1e-38\nphysical_punishment  -0.991665    0.0797906  -12.43    &lt;1e-34\nidentity: 1.0        -0.300475    0.217029    -1.38    0.1662\nintervention: 1.0     0.639641    0.217452     2.94    0.0033\nHDI                  -0.0032286   0.0199255   -0.16    0.8713\n─────────────────────────────────────────────────────────────",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Cross Sectional Multilevel Models</span>"
    ]
  },
  {
    "objectID": "cross-sectional-multilingual.html#interpretation",
    "href": "cross-sectional-multilingual.html#interpretation",
    "title": "5  Cross Sectional Multilevel Models",
    "section": "5.4 Interpretation",
    "text": "5.4 Interpretation\nModels suggest that parental warmth is associated with increases in the beneficial outcome, while physical punishment is associated with decreases in the beneficial outcome. The intervention is associated with increases in the outcome. There is insufficient evidence that either identity group or the Human Development Index are associated with the outcome.\n\n\n\n\nBates, D. (2024). MixedModels.jl Documentation. https://juliastats.org/MixedModels.jl/stable/\n\n\nBates, D., Mächler, M., Bolker, B., & Walker, S. (2015). Fitting linear mixed-effects models using lme4. Journal of Statistical Software, 67(1), 1–48. https://doi.org/10.18637/jss.v067.i01\n\n\nStataCorp. (2023). Stata 18 mixed effects reference manual. Stata Press.",
    "crumbs": [
      "<span class='chapter-number'>5</span>  <span class='chapter-title'>Cross Sectional Multilevel Models</span>"
    ]
  },
  {
    "objectID": "longitudinal-multilingual.html",
    "href": "longitudinal-multilingual.html",
    "title": "6  Longitudinal Multilevel Models",
    "section": "",
    "text": "6.1 The Data\nThe data employed in these examples are a longitudinal extension of the data described in Section 1.2.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Longitudinal Multilevel Models</span>"
    ]
  },
  {
    "objectID": "longitudinal-multilingual.html#the-equation",
    "href": "longitudinal-multilingual.html#the-equation",
    "title": "6  Longitudinal Multilevel Models",
    "section": "6.2 The Equation",
    "text": "6.2 The Equation\n\\[\\text{outcome}_{itj} = \\beta_0 + \\beta_1 \\text{parental warmth}_{itj} + \\beta_2 \\text{physical punishment}_{itj} + \\beta_3 \\text{time}_{itj} \\ +  \\tag{6.1}\\]\n\\[\\beta_4 \\text{identity}_{itj} + \\beta_5 \\text{intervention}_{itj} + \\beta_6 \\text{HDI}_{j} +\\]\n\\[u_{0j} + u_{1j} \\times \\text{parental warmth}_{itj} \\ + \\]\n\\[v_{0ij} + v_{1ij} \\times \\text{time}_{itj} + e_{itj}\\]",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Longitudinal Multilevel Models</span>"
    ]
  },
  {
    "objectID": "longitudinal-multilingual.html#growth-trajectories",
    "href": "longitudinal-multilingual.html#growth-trajectories",
    "title": "6  Longitudinal Multilevel Models",
    "section": "6.3 Growth Trajectories",
    "text": "6.3 Growth Trajectories\nRemember, following the discussion in the main text, that in longitudinal multilevel models, the variable for time assumes an important role as we are often thinking of a growth trajectory over time.\nAs discussed in the main text, think about a model where identity is a (1/0) variable for membership in one of two groups:\n\\[\\text{outcome} = \\beta_0 + \\beta_t \\text{time} + \\beta_\\text{identity} \\text{identity} + \\beta_\\text{interaction} \\text{identity} \\times \\text{time} + u_{0i} + e_{it}\\]\nThen, each identity group has its own intercept and time trajectory:\n\n\n\nTable 6.1: Slope and Intercept for Each Group\n\n\n\n\n\n\n\n\n\n\nGroup\nIntercept\nSlope (Time Trajectory)\n\n\n\n\n0\n\\(\\beta_0\\)\n\\(\\beta_t\\)\n\n\n1\n\\(\\beta_0 + \\beta_\\text{identity}\\)\n\\(\\beta_t + \\beta_\\text{interaction}\\)\n\n\n\n\n\n\n\n\n\n\n\n\nMain Effects and Interactions\n\n\n\nThus, again following the main text, in longitudinal multilevel models, main effects modify the intercept of the time trajectory, while interactions with time, modify the slope of the time trajectory. Below, we run models with main effects only, then models with main effects, and interactions with time.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Longitudinal Multilevel Models</span>"
    ]
  },
  {
    "objectID": "longitudinal-multilingual.html#run-models",
    "href": "longitudinal-multilingual.html#run-models",
    "title": "6  Longitudinal Multilevel Models",
    "section": "6.4 Run Models",
    "text": "6.4 Run Models\n\n\n\n\n\n\nWarning\n\n\n\nRemember that we are estimating a model in which time points are nested inside families, who are in turn nested inside countries. For each software package, it is accordingly important to specify the way in which different levels of the data are nested. Pay careful attention to the syntax examples below with regard to id and country\n\n\n\nStataRJulia\n\n\n\n6.4.0.1 Get The Data\n\n\nuse simulated_multilevel_longitudinal_data.dta\n\n\n\n6.4.0.2 Run The Models\n\n6.4.0.2.1 Main Effects Only\n\nmixed outcome t warmth physical_punishment i.identity i.intervention HDI || /// \ncountry: warmth || id: t\n\nPerforming EM optimization ...\n\nPerforming gradient-based optimization: \nIteration 0:  Log likelihood =  -28523.49  \nIteration 1:  Log likelihood = -28499.987  \nIteration 2:  Log likelihood = -28499.739  \nIteration 3:  Log likelihood = -28499.604  \nIteration 4:  Log likelihood = -28499.603  \n\nComputing standard errors ...\n\nMixed-effects ML regression                            Number of obs =   9,000\n\n        Grouping information\n        -------------------------------------------------------------\n                        |     No. of       Observations per group\n         Group variable |     groups    Minimum    Average    Maximum\n        ----------------+--------------------------------------------\n                country |         30        300      300.0        300\n                     id |      3,000          3        3.0          3\n        -------------------------------------------------------------\n\n                                                       Wald chi2(6)  = 1096.15\nLog likelihood = -28499.603                            Prob &gt; chi2   =  0.0000\n\n-------------------------------------------------------------------------------------\n            outcome | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]\n--------------------+----------------------------------------------------------------\n                  t |    .943864   .0658716    14.33   0.000      .814758     1.07297\n             warmth |   .9134959   .0423732    21.56   0.000      .830446    .9965459\nphysical_punishment |  -1.007897   .0497622   -20.25   0.000    -1.105429   -.9103647\n         1.identity |  -.1276926   .1515835    -0.84   0.400    -.4247908    .1694057\n     1.intervention |   .8589966   .1519095     5.65   0.000     .5612596    1.156734\n                HDI |  -.0005657   .0196437    -0.03   0.977    -.0390666    .0379352\n              _cons |   50.46724   1.338318    37.71   0.000     47.84418    53.09029\n-------------------------------------------------------------------------------------\n\n------------------------------------------------------------------------------\n  Random-effects parameters  |   Estimate   Std. err.     [95% conf. interval]\n-----------------------------+------------------------------------------------\ncountry: Independent         |\n                 var(warmth) |   .0107586   .0127845      .0010478    .1104703\n                  var(_cons) |   3.167085   .9146761      1.798154    5.578181\n-----------------------------+------------------------------------------------\nid: Independent              |\n                      var(t) |   3.58e-09   7.06e-07      3.5e-177    3.7e+159\n                  var(_cons) |   8.387275   .4724188      7.510631    9.366242\n-----------------------------+------------------------------------------------\n               var(Residual) |   26.02733   .4753701      25.11211    26.97592\n------------------------------------------------------------------------------\nLR test vs. linear model: chi2(4) = 1247.03               Prob &gt; chi2 = 0.0000\n\nNote: LR test is conservative and provided only for reference.\n\n\n\n\n6.4.0.2.2 Interactions With Time\n\nmixed outcome c.t##(c.warmth c.physical_punishment i.identity i.intervention c.HDI) || country: warmth || id: t\n\nPerforming EM optimization ...\n\nPerforming gradient-based optimization: \nIteration 0:  Log likelihood =  -28522.21  \nIteration 1:  Log likelihood = -28498.677  \nIteration 2:  Log likelihood = -28498.468  \nIteration 3:  Log likelihood =  -28498.31  \nIteration 4:  Log likelihood = -28498.309  \n\nComputing standard errors ...\n\nMixed-effects ML regression                            Number of obs =   9,000\n\n        Grouping information\n        -------------------------------------------------------------\n                        |     No. of       Observations per group\n         Group variable |     groups    Minimum    Average    Maximum\n        ----------------+--------------------------------------------\n                country |         30        300      300.0        300\n                     id |      3,000          3        3.0          3\n        -------------------------------------------------------------\n\n                                                       Wald chi2(11) = 1100.25\nLog likelihood = -28498.309                            Prob &gt; chi2   =  0.0000\n\n---------------------------------------------------------------------------------------\n              outcome | Coefficient  Std. err.      z    P&gt;|z|     [95% conf. interval]\n----------------------+----------------------------------------------------------------\n                    t |   .7582075    .326177     2.32   0.020     .1189123    1.397503\n               warmth |   .8170757    .082662     9.88   0.000     .6550611    .9790903\n  physical_punishment |  -1.009031   .1112932    -9.07   0.000    -1.227162   -.7909007\n           1.identity |  -.2387167   .3039964    -0.79   0.432    -.8345387    .3571053\n       1.intervention |   .6607606   .3044503     2.17   0.030      .064049    1.257472\n                  HDI |   .0013614   .0210842     0.06   0.949    -.0399628    .0426856\n                      |\n         c.t#c.warmth |   .0483637   .0356074     1.36   0.174    -.0214255    .1181529\n                      |\n                  c.t#|\nc.physical_punishment |   .0005421   .0494354     0.01   0.991    -.0963496    .0974338\n                      |\n         identity#c.t |\n                   1  |   .0554389   .1317444     0.42   0.674    -.2027754    .3136532\n                      |\n     intervention#c.t |\n                   1  |   .0992811    .131925     0.75   0.452    -.1592872    .3578493\n                      |\n            c.t#c.HDI |  -.0009551   .0038216    -0.25   0.803    -.0084453    .0065352\n                      |\n                _cons |   50.83632   1.483548    34.27   0.000     47.92862    53.74402\n---------------------------------------------------------------------------------------\n\n------------------------------------------------------------------------------\n  Random-effects parameters  |   Estimate   Std. err.     [95% conf. interval]\n-----------------------------+------------------------------------------------\ncountry: Independent         |\n                 var(warmth) |   .0106014   .0127458      .0010046    .1118779\n                  var(_cons) |   3.170088   .9153355       1.80009    5.582753\n-----------------------------+------------------------------------------------\nid: Independent              |\n                      var(t) |   9.47e-10   2.07e-07      1.5e-195    6.0e+176\n                  var(_cons) |    8.39189   .4724106      7.515234    9.370809\n-----------------------------+------------------------------------------------\n               var(Residual) |   26.01583   .4751602      25.10101      26.964\n------------------------------------------------------------------------------\nLR test vs. linear model: chi2(4) = 1247.84               Prob &gt; chi2 = 0.0000\n\nNote: LR test is conservative and provided only for reference.\n\n\n\n\n\n\n\n6.4.0.3 Get The Data\n\nlibrary(haven)\n\ndfL &lt;- read_dta(\"simulated_multilevel_longitudinal_data.dta\")\n\n\n\n6.4.0.4 Change Some Variables To Categorical\n\ndfL$identity &lt;- factor(dfL$identity)\n\ndfL$intervention &lt;- factor(dfL$intervention)\n\n\n\n6.4.0.5 Run The Models\n\n\n\n\n\n\nCaution\n\n\n\n\n\nlme4 does not directly provide p values in results, because of some disagreement over exactly how these p values should be calculated. Therefore, in this Appendix, I also call library lmerTest to provide p values for lme4 results.\n\n\n\n\n\n\n\n\n\nTip\n\n\n\nR prefers to use scientific notation when possible. I find that the use of scientific notation can be confusing in reading results. I turn off scientific notation by setting a penalty for its use: options(scipen = 999).\n\n\n\n6.4.0.5.1 Main Effects Only\n\nlibrary(lme4) \n\nlibrary(lmerTest)\n\noptions(scipen = 999) \n\nfit2A &lt;- lmer(outcome ~ t + warmth + physical_punishment + \n               identity + intervention + HDI +\n               (1 | country/id),\n             data = dfL)\n\nsummary(fit2A)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: \noutcome ~ t + warmth + physical_punishment + identity + intervention +  \n    HDI + (1 | country/id)\n   Data: dfL\n\nREML criterion at convergence: 57022.7\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.6850 -0.6094 -0.0035  0.6133  3.6792 \n\nRandom effects:\n Groups     Name        Variance Std.Dev.\n id:country (Intercept)  8.438   2.905   \n country    (Intercept)  3.675   1.917   \n Residual               26.036   5.103   \nNumber of obs: 9000, groups:  id:country, 3000; country, 30\n\nFixed effects:\n                        Estimate   Std. Error           df t value\n(Intercept)           50.3842343    1.4139114   29.8246912  35.635\nt                      0.9433806    0.0658755 5998.3764548  14.321\nwarmth                 0.9140307    0.0379336 4745.3497493  24.096\nphysical_punishment   -1.0087537    0.0497972 6483.6771808 -20.257\nidentity1             -0.1319548    0.1517350 2968.7828107  -0.870\nintervention1          0.8591494    0.1520510 2971.8111995   5.650\nHDI                    0.0007909    0.0207656   28.0001855   0.038\n                                Pr(&gt;|t|)    \n(Intercept)         &lt; 0.0000000000000002 ***\nt                   &lt; 0.0000000000000002 ***\nwarmth              &lt; 0.0000000000000002 ***\nphysical_punishment &lt; 0.0000000000000002 ***\nidentity1                          0.385    \nintervention1               0.0000000175 ***\nHDI                                0.970    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) t      warmth physc_ idntt1 intrv1\nt           -0.092                                   \nwarmth      -0.091 -0.002                            \nphyscl_pnsh -0.092 -0.007 -0.012                     \nidentity1   -0.051  0.000 -0.013 -0.003              \ninterventn1 -0.058  0.000  0.039  0.019 -0.018       \nHDI         -0.951  0.000 -0.004  0.005  0.000  0.002\n\n\n\n\n6.4.0.5.2 Interactions With Time\n\nfit2B &lt;- lmer(outcome ~ t *(warmth + physical_punishment + \n               identity + intervention + HDI) +\n               (1 | country/id),\n             data = dfL)\n\nsummary(fit2B)\n\nLinear mixed model fit by REML. t-tests use Satterthwaite's method [\nlmerModLmerTest]\nFormula: \noutcome ~ t * (warmth + physical_punishment + identity + intervention +  \n    HDI) + (1 | country/id)\n   Data: dfL\n\nREML criterion at convergence: 57042.8\n\nScaled residuals: \n    Min      1Q  Median      3Q     Max \n-3.7118 -0.6092 -0.0024  0.6150  3.6779 \n\nRandom effects:\n Groups     Name        Variance Std.Dev.\n id:country (Intercept)  8.436   2.905   \n country    (Intercept)  3.675   1.917   \n Residual               26.046   5.104   \nNumber of obs: 9000, groups:  id:country, 3000; country, 30\n\nFixed effects:\n                          Estimate   Std. Error           df t value\n(Intercept)             50.7590272    1.5518360   43.2608620  32.709\nt                        0.7552909    0.3263028 6176.7440549   2.315\nwarmth                   0.8170912    0.0805355 8274.9995422  10.146\nphysical_punishment     -1.0097729    0.1113557 8084.6084915  -9.068\nidentity1               -0.2446453    0.3041604 8695.8966197  -0.804\nintervention1            0.6604671    0.3046286 8697.0843430   2.168\nHDI                      0.0026692    0.0221295   36.1037733   0.121\nt:warmth                 0.0486211    0.0356217 6404.8723333   1.365\nt:physical_punishment    0.0004964    0.0494590 6753.0158441   0.010\nt:identity1              0.0563140    0.1318043 5993.4518022   0.427\nt:intervention1          0.0995037    0.1319917 5994.1433001   0.754\nt:HDI                   -0.0009379    0.0038233 5993.9090880  -0.245\n                                 Pr(&gt;|t|)    \n(Intercept)           &lt;0.0000000000000002 ***\nt                                  0.0207 *  \nwarmth                &lt;0.0000000000000002 ***\nphysical_punishment   &lt;0.0000000000000002 ***\nidentity1                          0.4212    \nintervention1                      0.0302 *  \nHDI                                0.9047    \nt:warmth                           0.1723    \nt:physical_punishment              0.9920    \nt:identity1                        0.6692    \nt:intervention1                    0.4510    \nt:HDI                              0.8062    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nCorrelation of Fixed Effects:\n            (Intr) t      warmth physc_ idntt1 intrv1 HDI    t:wrmt t:phy_\nt           -0.421                                                        \nwarmth      -0.178  0.331                                                 \nphyscl_pnsh -0.190  0.360 -0.005                                          \nidentity1   -0.093  0.166 -0.013 -0.002                                   \ninterventn1 -0.107  0.192  0.039  0.019 -0.017                            \nHDI         -0.925  0.264 -0.007  0.012 -0.001  0.003                     \nt:warmth     0.158 -0.377 -0.882  0.001  0.011 -0.035  0.006              \nt:physcl_pn  0.170 -0.402  0.004 -0.894 -0.001 -0.017 -0.010 -0.003       \nt:identity1  0.081 -0.192  0.011  0.000 -0.867  0.014  0.001 -0.013  0.002\nt:intrvntn1  0.093 -0.222 -0.035 -0.017  0.014 -0.867 -0.003  0.041  0.019\nt:HDI        0.322 -0.765  0.015 -0.027  0.002 -0.007 -0.346 -0.016  0.029\n            t:dnt1 t:ntr1\nt                        \nwarmth                   \nphyscl_pnsh              \nidentity1                \ninterventn1              \nHDI                      \nt:warmth                 \nt:physcl_pn              \nt:identity1              \nt:intrvntn1 -0.016       \nt:HDI       -0.002  0.008\n\n\n\n\n\n\n\n6.4.0.6 Get The Data\n\nusing Tables, MixedModels, StatFiles, DataFrames, CategoricalArrays, DataFramesMeta\n\ndfL = DataFrame(load(\"simulated_multilevel_longitudinal_data.dta\"))\n\n\n\n6.4.0.7 Change Some Variables To Categorical\n\n@transform!(dfL, :country = categorical(:country))\n\n@transform!(dfL, :identity = categorical(:identity))\n\n@transform!(dfL, :intervention = categorical(:intervention))\n\n\n\n6.4.0.8 Run The Models\n\n6.4.0.8.1 Main Effects Only\n\nm2A = fit(MixedModel, @formula(outcome ~ t + warmth + \n                                 physical_punishment + \n                                 identity + intervention + \n                                 HDI +\n                                 (1 | country) + \n                                 (0 + warmth | country) +\n                                 (1 | id)), dfL)\n\nLinear mixed model fit by maximum likelihood\n outcome ~ 1 + t + warmth + physical_punishment + identity + intervention + HDI + (1 | country) + (0 + warmth | country) + (1 | id)\n    logLik   -2 logLik      AIC         AICc        BIC     \n -28499.6031  56999.2063  57021.2063  57021.2356  57099.3610\n\nVariance components:\n            Column    Variance Std.Dev.   Corr.\nid       (Intercept)   8.387214 2.896069\ncountry  (Intercept)   3.167143 1.779647\n         warmth        0.010762 0.103739   .  \nResidual              26.027363 5.101702\n Number of obs: 9000; levels of grouping factors: 3000, 30\n\n  Fixed-effects parameters:\n───────────────────────────────────────────────────────────────\n                            Coef.  Std. Error       z  Pr(&gt;|z|)\n───────────────────────────────────────────────────────────────\n(Intercept)          50.4673        1.33833     37.71    &lt;1e-99\nt                     0.943864      0.0658717   14.33    &lt;1e-45\nwarmth                0.913496      0.0423744   21.56    &lt;1e-99\nphysical_punishment  -1.0079        0.0497622  -20.25    &lt;1e-90\nidentity: 1.0        -0.127692      0.151583    -0.84    0.3996\nintervention: 1.0     0.858997      0.151909     5.65    &lt;1e-07\nHDI                  -0.000566026   0.0196439   -0.03    0.9770\n───────────────────────────────────────────────────────────────\n\n\n\n\n6.4.0.8.2 Interactions With Time\n\nm2B = fit(MixedModel, @formula(outcome ~ t * (warmth + \n                                 physical_punishment + \n                                 identity + intervention + \n                                   HDI) +\n                                 (1 | country) +\n                                 (0 + warmth | country) +\n                                 (1 | id)), dfL)\n\nLinear mixed model fit by maximum likelihood\n outcome ~ 1 + t + warmth + physical_punishment + identity + intervention + HDI + t & warmth + t & physical_punishment + t & identity + t & intervention + t & HDI + (1 | country) + (0 + warmth | country) + (1 | id)\n    logLik   -2 logLik      AIC         AICc        BIC     \n -28498.3091  56996.6182  57028.6182  57028.6788  57142.2979\n\nVariance components:\n            Column    Variance Std.Dev.   Corr.\nid       (Intercept)   8.391746 2.896851\ncountry  (Intercept)   3.170032 1.780458\n         warmth        0.010609 0.102999   .  \nResidual              26.015906 5.100579\n Number of obs: 9000; levels of grouping factors: 3000, 30\n\n  Fixed-effects parameters:\n──────────────────────────────────────────────────────────────────\n                                Coef.  Std. Error      z  Pr(&gt;|z|)\n──────────────────────────────────────────────────────────────────\n(Intercept)              50.8364       1.48355     34.27    &lt;1e-99\nt                         0.758209     0.326177     2.32    0.0201\nwarmth                    0.817076     0.0826636    9.88    &lt;1e-22\nphysical_punishment      -1.00903      0.111293    -9.07    &lt;1e-18\nidentity: 1.0            -0.238714     0.303996    -0.79    0.4323\nintervention: 1.0         0.660761     0.30445      2.17    0.0300\nHDI                       0.00136065   0.0210842    0.06    0.9485\nt & warmth                0.0483635    0.0356074    1.36    0.1744\nt & physical_punishment   0.000542203  0.0494355    0.01    0.9912\nt & identity: 1.0         0.0554385    0.131745     0.42    0.6739\nt & intervention: 1.0     0.0992809    0.131925     0.75    0.4517\nt & HDI                  -0.000955067  0.00382162  -0.25    0.8027\n──────────────────────────────────────────────────────────────────",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Longitudinal Multilevel Models</span>"
    ]
  },
  {
    "objectID": "longitudinal-multilingual.html#interpretation",
    "href": "longitudinal-multilingual.html#interpretation",
    "title": "6  Longitudinal Multilevel Models",
    "section": "6.5 Interpretation",
    "text": "6.5 Interpretation\nThe main effects only model suggests that time is associated with increases in the outcome. In the main effects model, main effects other than time, indicate whether a particular variable is associated with higher or lower intercepts of the time trajectory, at the beginning of the study time. Warmth is again associated with increases in the outcome, while physical punishment is associated with decreases in the outcome. Identity is again not associated with the outcome, while the intervention is associated with higher levels of the outcome. The Human Development Index is again not associated with the outcome.\nThe second model adds interactions with time to the first model. Results are largely similar to the prior model. However, here we not only examine whether main effects other than time are associated with higher or lower time trajectories, but also whether particular variables are associated with differences in the slope of the time trajectory. In this case, we find insufficient evidence that any independent variable is associated with changes in the slope of the time trajectory.\n\n\n\n\n\n\nWhich Interactions To Test?\n\n\n\nIn this example–for the sake of illustration–I test the interaction of every independent variable with time. In many cases, it may make sense to test only only one or two interactions of time with particular variables of key interest. Also, after finding, as I did in this model, that none of the interactions of other independent variables with time are significant, I might report the model with interactions, or might report only the results of the model with only main effects.\n\n\nIt may be illustrative to imagine how we would interpret the results had a particular interaction term been statistically significant. Let us consider one of the interaction terms with the largest coefficient, intervention#time. The interaction of the intervention with time is positive. Had this coefficient been statistically signifcant, it would have indicated that the intervention was associated with more rapid increases in the outcome over time in addition to the fact that the intervention is associated with higher initial levels of the outcome.",
    "crumbs": [
      "<span class='chapter-number'>6</span>  <span class='chapter-title'>Longitudinal Multilevel Models</span>"
    ]
  },
  {
    "objectID": "reshape-multilingual.html",
    "href": "reshape-multilingual.html",
    "title": "7  Reshaping Data",
    "section": "",
    "text": "7.1 Introduction\nCross-sectional analyses (Chapter 5) make use of data in wide format: every row is a person, or family, and every person, or family, has a single row of data.\nLongitudinal analyses (Chapter 6) make use of long data: every row is a person-timepoint, or family-timepoint, and every person, or family, has multiple rows of data.\nData therefore sometimes need to be reshaped, most often from wide format to long format. Almost any software that is capable of estimating multilevel models is capable of reshaping data.\nBelow, I detail the procedure for reshaping data in Stata and R.",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Reshaping Data</span>"
    ]
  },
  {
    "objectID": "reshape-multilingual.html#data-in-wide-format",
    "href": "reshape-multilingual.html#data-in-wide-format",
    "title": "7  Reshaping Data",
    "section": "7.2 Data in Wide Format",
    "text": "7.2 Data in Wide Format\n\n\n\n\n\n\nNote\n\n\n\nThe data below are in wide format.\nEvery individual in the data set has a single row of data. Every row in the data set is an individual or family.\n\n\n\n\n\n\nTable 7.1: Data in Wide Format\n\n\n\n\nTable continues below\n\n\n\n\n\n\n\n\n\nid\nphysical_punishment1\nwarmth1\noutcome1\nphysical_punishment2\n\n\n\n\n1.1\n3\n3\n57.47\n3\n\n\n1.10\n2\n0\n62.9\n3\n\n\n1.100\n2\n5\n62.71\n1\n\n\n1.11\n4\n4\n55.61\n2\n\n\n1.12\n5\n4\n41.15\n5\n\n\n1.13\n4\n5\n63.66\n3\n\n\n\n\nTable continues below\n\n\n\n\n\n\n\n\n\n\n\nwarmth2\noutcome2\nphysical_punishment3\nwarmth3\noutcome3\ncountry\nHDI\n\n\n\n\n4\n55.06\n1\n2\n58.77\n1\n69\n\n\n0\n56.67\n2\n0\n68.22\n1\n69\n\n\n4\n51.58\n2\n5\n55.51\n1\n69\n\n\n5\n50.9\n3\n3\n48.02\n1\n69\n\n\n5\n45.4\n3\n4\n55.86\n1\n69\n\n\n3\n64.81\n3\n3\n58.3\n1\n69\n\n\n\n\n\n\n\n\n\n\n\nfamily\nidentity\nintervention\n\n\n\n\n1\n1\n0\n\n\n10\n1\n0\n\n\n100\n1\n1\n\n\n11\n1\n1\n\n\n12\n0\n0\n\n\n13\n0\n1",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Reshaping Data</span>"
    ]
  },
  {
    "objectID": "reshape-multilingual.html#data-management",
    "href": "reshape-multilingual.html#data-management",
    "title": "7  Reshaping Data",
    "section": "7.3 Data Management",
    "text": "7.3 Data Management\nBecause reshaping your data dramatically changes the structure of your data…\n\nIt is a good idea to have your raw data saved in a location where it will not be changed, and can be retrieved again if the reshape command does not work correctly, or if you simply want to modify your reshaping data workflow.(CF Section 2.3)\nUsually we want to work with only a subset of your data, to keep only the data in which we are interested.\n\nIn Stata, the command to keep only variables of interest would be: keep y x z t.\nIn R, one option would be to use the subset function: mysubset &lt;- subset(mydata, select = c(y, x, z, t))",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Reshaping Data</span>"
    ]
  },
  {
    "objectID": "reshape-multilingual.html#reshaping-data-from-wide-to-long",
    "href": "reshape-multilingual.html#reshaping-data-from-wide-to-long",
    "title": "7  Reshaping Data",
    "section": "7.4 Reshaping Data From Wide To Long",
    "text": "7.4 Reshaping Data From Wide To Long\nUsually, we are most interested in reshaping data from wide to long.\n\nStataR\n\n\nIn Stata, I only list variables that vary over time, or are time varying. Stata assumes that variables that are not listed do not vary over time, or are time invariant.\nNotice also that our time varying data are in the stub-time format, e.g. warmth1, warmth2, physical_punishment1 physical_punishment2, etc. Because the variables are named in this way, Stata knows to use the stub (e.g. warmth) as the variable name, and the numeric value, (e.g. 1, 2, 3) as the timepoint.\n\nThe id variable, whatever it is named, has to uniquely identify the observations. A useful Stata command here is isid, e.g. isid id. If your id variable is not unique, it is often due to missing values. drop if id == . usually solves the problem (assuming that your id variable is indeed named id, and not something else).\n\n\n\nuse simulated_multilevel_longitudinal_data_WIDE.dta, clear\n\ndescribe\n\nreshape long outcome physical_punishment warmth, i(id) j(wave)\n\nContains data from simulated_multilevel_longitudinal_data_WIDE.dta\n Observations:         3,000                  \n    Variables:            15                  3 Jul 2024 14:29\n-------------------------------------------------------------------------------------------\nVariable      Storage   Display    Value\n    name         type    format    label      Variable label\n-------------------------------------------------------------------------------------------\nid              str7    %9s                   unique country family id\nphysical_puni~1 float   %9.0g                 1 physical_punishment\nwarmth1         float   %9.0g                 1 warmth\noutcome1        float   %9.0g                 1 outcome\nphysical_puni~2 float   %9.0g                 2 physical_punishment\nwarmth2         float   %9.0g                 2 warmth\noutcome2        float   %9.0g                 2 outcome\nphysical_puni~3 float   %9.0g                 3 physical_punishment\nwarmth3         float   %9.0g                 3 warmth\noutcome3        float   %9.0g                 3 outcome\ncountry         float   %9.0g                 country id\nHDI             float   %9.0g                 Human Development Index\nfamily          float   %9.0g                 family id\nidentity        float   %9.0g                 hypothetical identity group variable\nintervention    float   %9.0g                 recieved intervention\n-------------------------------------------------------------------------------------------\nSorted by: id\n\n(j = 1 2 3)\n\nData                               Wide   -&gt;   Long\n-----------------------------------------------------------------------------\nNumber of observations            3,000   -&gt;   9,000       \nNumber of variables                  15   -&gt;   10          \nj variable (3 values)                     -&gt;   wave\nxij variables:\n             outcome1 outcome2 outcome3   -&gt;   outcome\nphysical_punishment1 physical_punishment2 physical_punishment3-&gt;physical_punishment\n                warmth1 warmth2 warmth3   -&gt;   warmth\n-----------------------------------------------------------------------------\n\n\n\n\nIn R, I only list variables that vary over time, or are time varying.\nNotice also that our time varying data are in the stub-time format, e.g. warmth1, warmth2, physical_punishment1 physical_punishment2, etc. In order to facilitate reshaping the data, it is helpful in R to insert an underscore (_) to separate the stub from the time variable.\n\nlibrary(dplyr) # data wrangling\n\nlibrary(tidyr) # tidy (reshape data)\n\n\n# rename variables with \"_\" separator\n\ndf &lt;- simulated_multilevel_longitudinal_data_WIDE %&gt;%\n  rename(outcome_1 = outcome1,\n         outcome_2 = outcome2,\n         outcome_3 = outcome3,\n         physical_punishment_1 = physical_punishment1,\n         physical_punishment_2 = physical_punishment2,\n         physical_punishment_3 = physical_punishment3,\n         warmth_1 = warmth1,\n         warmth_2 = warmth2,\n         warmth_3 = warmth3) \n\n\n# pivot_longer() to long data\n\ndfL &lt;- df %&gt;%\n  pivot_longer(cols = c(outcome_1,\n                        outcome_2,\n                        outcome_3,\n                        physical_punishment_1,\n                        physical_punishment_2,\n                        physical_punishment_3,\n                        warmth_1,\n                        warmth_2,\n                        warmth_3), \n               names_pattern = \"(.+)_(.+)\",\n               names_to = c(\".value\", \"t\"))",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Reshaping Data</span>"
    ]
  },
  {
    "objectID": "reshape-multilingual.html#data-in-long-format",
    "href": "reshape-multilingual.html#data-in-long-format",
    "title": "7  Reshaping Data",
    "section": "7.5 Data in Long Format",
    "text": "7.5 Data in Long Format\n\n\n\n\n\n\nNote\n\n\n\nThe data below are in long format.\nEvery individual/family in the data set has a multiple rows of data. Every row in the data set is an individual-timepoint or family-timepoint.\n\n\n\n\n\n\nTable 7.2: Data in Long Format\n\n\n\n\nTable continues below\n\n\n\n\n\n\n\n\n\n\n\ncountry\nHDI\nfamily\nid\nidentity\nintervention\nt\n\n\n\n\n1\n69\n1\n1.1\n1\n0\n1\n\n\n1\n69\n1\n1.1\n1\n0\n2\n\n\n1\n69\n1\n1.1\n1\n0\n3\n\n\n1\n69\n2\n1.2\n1\n1\n1\n\n\n1\n69\n2\n1.2\n1\n1\n2\n\n\n1\n69\n2\n1.2\n1\n1\n3\n\n\n\n\n\n\n\n\n\n\n\nphysical_punishment\nwarmth\noutcome\n\n\n\n\n3\n3\n57.47\n\n\n3\n4\n55.06\n\n\n1\n2\n58.77\n\n\n2\n1\n50.1\n\n\n3\n0\n53.31\n\n\n3\n1\n49.79",
    "crumbs": [
      "<span class='chapter-number'>7</span>  <span class='chapter-title'>Reshaping Data</span>"
    ]
  },
  {
    "objectID": "aggregating-multilingual.html",
    "href": "aggregating-multilingual.html",
    "title": "8  Aggregating Data",
    "section": "",
    "text": "In many instances, we may wish to aggregate data. For example, we may wish to create contextual variables representing the average level of an indicator across a group. In the examples I am using in this book, the group under consideration is the country. Aggregating data is also an important part of discussions of within and between variation, and is an important part of the correlated random effects model.\nIn the examples below, I create a group level variable for warmth, representing the average level of parental warmth in each country. If warmth is denoted by \\(\\text{warmth}_{ij}\\) then the country level variable is denoted by \\(\\overline{warmth}_{.j}\\).\nBelow, I detail the procedure for aggregating data in Stata and R.\n\nStataR\n\n\n\n8.0.0.1 Get The Data\n\n\nuse simulated_multilevel_data.dta\n\n\n\n8.0.0.2 Create A Group Level Variable\n\n\nbysort country: egen mean_warmth = mean(warmth)\n\n\n\n\n\n8.0.0.3 Get The Data\n\nlibrary(haven)\n\ndf &lt;- read_dta(\"simulated_multilevel_data.dta\")\n\n\n\n8.0.0.4 Create A Group Level Variable\n\nlibrary(dplyr) \n\ndf &lt;- df %&gt;% \n  group_by(country) %&gt;%\n  mutate(mean_warmth = mean(warmth))",
    "crumbs": [
      "<span class='chapter-number'>8</span>  <span class='chapter-title'>Aggregating Data</span>"
    ]
  },
  {
    "objectID": "references.html",
    "href": "references.html",
    "title": "References",
    "section": "",
    "text": "Allaire, J. J., Teague, C., Scheidegger, C., Xie, Y., & Dervieux, C.\n(2024). Quarto (Version 1.4). https://doi.org/10.5281/zenodo.5960048\n\n\nBates, D. (2024). MixedModels.jl\nDocumentation. https://juliastats.org/MixedModels.jl/stable/\n\n\nBates, D., Mächler, M., Bolker, B., & Walker, S. (2015). Fitting\nlinear mixed-effects models using lme4. Journal of Statistical\nSoftware, 67(1), 1–48. https://doi.org/10.18637/jss.v067.i01\n\n\nBezanson, J., Edelman, A., Karpinski, S., & Shah, V. B. (2017).\nJulia: A fresh approach to numerical computing. SIAM Review,\n59(1), 65–98. https://doi.org/10.1137/141000671\n\n\nHemken, D. (2023). Statamarkdown: ’Stata’ markdown. https://CRAN.R-project.org/package=Statamarkdown\n\n\nLi, C. (2019). JuliaCall: An R package for\nseamless integration between R and Julia.\nThe Journal of Open Source Software, 4(35), 1284. https://doi.org/10.21105/joss.01284\n\n\nR Core Team. (2023). R: A language and environment for statistical\ncomputing. R Foundation for Statistical Computing. https://www.R-project.org/\n\n\nSchanen, J. (2021). Math person (Strogatz Prize\nentry). National Museum of Mathematics.\n\n\nStataCorp. (2023). Stata 18 mixed effects reference manual.\nStata Press.\n\n\nThoreau, H. D. (1975). The commercial spirit of modern times [1837]. In\nJ. J. Moldenhauer, E. Moser, & A. C. Kern (Eds.), Early essays\nand miscellanies. Princeton University Press.",
    "crumbs": [
      "References"
    ]
  }
]